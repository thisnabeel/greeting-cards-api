/*!
 * froala_editor v2.8.5 (https://www.froala.com/wysiwyg-editor)
 * License https://froala.com/wysiwyg-editor/terms/
 * Copyright 2014-2018 Froala Labs
 */
!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof module&&module.exports?module.exports=function(t,i){return void 0===i&&(i="undefined"!=typeof window?require("jquery"):require("jquery")(t)),e(i)}:e(window.jQuery)}(function(e){e.extend(e.FE.POPUP_TEMPLATES,{"video.insert":"[_BUTTONS_][_BY_URL_LAYER_][_EMBED_LAYER_][_UPLOAD_LAYER_][_PROGRESS_BAR_]","video.edit":"[_BUTTONS_]","video.size":"[_BUTTONS_][_SIZE_LAYER_]"}),e.extend(e.FE.DEFAULTS,{videoAllowedTypes:["mp4","webm","ogg"],videoAllowedProviders:[".*"],videoDefaultAlign:"center",videoDefaultDisplay:"block",videoDefaultWidth:600,videoEditButtons:["videoReplace","videoRemove","|","videoDisplay","videoAlign","videoSize"],videoInsertButtons:["videoBack","|","videoByURL","videoEmbed","videoUpload"],videoMaxSize:52428800,videoMove:!0,videoResize:!0,videoSizeButtons:["videoBack","|"],videoSplitHTML:!1,videoTextNear:!0,videoUpload:!0,videoUploadMethod:"POST",videoUploadParam:"file",videoUploadParams:{},videoUploadToS3:!1,videoUploadURL:null}),e.FE.VIDEO_PROVIDERS=[{test_regex:/^.*((youtu.be)|(youtube.com))\/((v\/)|(\/u\/\w\/)|(embed\/)|(watch\?))?\??v?=?([^#\&\?]*).*/,url_regex:/(?:https?:\/\/)?(?:www\.)?(?:m\.)?(?:youtube\.com|youtu\.be)\/(?:watch\?v=|embed\/)?([0-9a-zA-Z_\-]+)(.+)?/g,url_text:"https://www.youtube.com/embed/$1",html:'<iframe width="640" height="360" src="{url}?wmode=opaque" frameborder="0" allowfullscreen></iframe>',provider:"youtube"},{test_regex:/^.*(?:vimeo.com)\/(?:channels(\/\w+\/)?|groups\/*\/videos\/\u200b\d+\/|video\/|)(\d+)(?:$|\/|\?)/,url_regex:/(?:https?:\/\/)?(?:www\.|player\.)?vimeo.com\/(?:channels\/(?:\w+\/)?|groups\/(?:[^\/]*)\/videos\/|album\/(?:\d+)\/video\/|video\/|)(\d+)(?:[a-zA-Z0-9_\-]+)?(\/[a-zA-Z0-9_\-]+)?/i,url_text:"https://player.vimeo.com/video/$1",html:'<iframe width="640" height="360" src="{url}" frameborder="0" allowfullscreen></iframe>',provider:"vimeo"},{test_regex:/^.+(dailymotion.com|dai.ly)\/(video|hub)?\/?([^_]+)[^#]*(#video=([^_&]+))?/,url_regex:/(?:https?:\/\/)?(?:www\.)?(?:dailymotion\.com|dai\.ly)\/(?:video|hub)?\/?(.+)/g,url_text:"https://www.dailymotion.com/embed/video/$1",html:'<iframe width="640" height="360" src="{url}" frameborder="0" allowfullscreen></iframe>',provider:"dailymotion"},{test_regex:/^.+(screen.yahoo.com)\/[^_&]+/,url_regex:"",url_text:"",html:'<iframe width="640" height="360" src="{url}?format=embed" frameborder="0" allowfullscreen="true" mozallowfullscreen="true" webkitallowfullscreen="true" allowtransparency="true"></iframe>',provider:"yahoo"},{test_regex:/^.+(rutube.ru)\/[^_&]+/,url_regex:/(?:https?:\/\/)?(?:www\.)?(?:rutube\.ru)\/(?:video)?\/?(.+)/g,url_text:"https://rutube.ru/play/embed/$1",html:'<iframe width="640" height="360" src="{url}" frameborder="0" allowfullscreen="true" mozallowfullscreen="true" webkitallowfullscreen="true" allowtransparency="true"></iframe>',provider:"rutube"},{test_regex:/^(?:.+)vidyard.com\/(?:watch)?\/?([^.&\/]+)\/?(?:[^_.&]+)?/,url_regex:/^(?:.+)vidyard.com\/(?:watch)?\/?([^.&\/]+)\/?(?:[^_.&]+)?/g,url_text:"https://play.vidyard.com/$1",html:'<iframe width="640" height="360" src="{url}" frameborder="0" allowfullscreen></iframe>',provider:"vidyard"}],e.FE.VIDEO_EMBED_REGEX=/^\W*((<iframe.*><\/iframe>)|(<embed.*>))\W*$/i,e.FE.PLUGINS.video=function(t){function i(){var e=t.popups.get("video.insert");e.find(".fr-video-by-url-layer input").val("").trigger("change");var i=e.find(".fr-video-embed-layer textarea");i.val("").trigger("change"),(i=e.find(".fr-video-upload-layer input")).val("").trigger("change")}function o(){var e=t.popups.get("video.edit");if(e||(e=function(){var e="";if(0<t.opts.videoEditButtons.length){e+='<div class="fr-buttons">',e+=t.button.buildList(t.opts.videoEditButtons);var i={buttons:e+="</div>"},o=t.popups.create("video.edit",i);return t.events.$on(t.$wp,"scroll.video-edit",function(){V&&t.popups.isVisible("video.edit")&&(t.events.disableBlur(),v(V))}),o}return!1}()),e){t.popups.setContainer("video.edit",t.$sc),t.popups.refresh("video.edit");var i=V.find("iframe, embed, video"),o=i.offset().left+i.outerWidth()/2,r=i.offset().top+i.outerHeight();t.popups.show("video.edit",o,r,i.outerHeight())}}function r(o){if(o)return t.popups.onRefresh("video.insert",i),t.popups.onHide("image.insert",L),!0;var r="";t.opts.videoUpload||t.opts.videoInsertButtons.splice(t.opts.videoInsertButtons.indexOf("videoUpload"),1),1<t.opts.videoInsertButtons.length&&(r='<div class="fr-buttons">'+t.button.buildList(t.opts.videoInsertButtons)+"</div>");var s,n="",a=t.opts.videoInsertButtons.indexOf("videoUpload"),d=t.opts.videoInsertButtons.indexOf("videoByURL"),l=t.opts.videoInsertButtons.indexOf("videoEmbed");d>=0&&(s=" fr-active",(d>a&&a>=0||d>l&&l>=0)&&(s=""),n='<div class="fr-video-by-url-layer fr-layer'+s+'" id="fr-video-by-url-layer-'+t.id+'"><div class="fr-input-line"><input id="fr-video-by-url-layer-text-'+t.id+'" type="text" placeholder="'+t.language.translate("Paste in a video URL")+'" tabIndex="1" aria-required="true"></div><div class="fr-action-buttons"><button type="button" class="fr-command fr-submit" data-cmd="videoInsertByURL" tabIndex="2" role="button">'+t.language.translate("Insert")+"</button></div></div>");var f="";l>=0&&(s=" fr-active",(l>a&&a>=0||l>d&&d>=0)&&(s=""),f='<div class="fr-video-embed-layer fr-layer'+s+'" id="fr-video-embed-layer-'+t.id+'"><div class="fr-input-line"><textarea id="fr-video-embed-layer-text'+t.id+'" type="text" placeholder="'+t.language.translate("Embedded Code")+'" tabIndex="1" aria-required="true" rows="5"></textarea></div><div class="fr-action-buttons"><button type="button" class="fr-command fr-submit" data-cmd="videoInsertEmbed" tabIndex="2" role="button">'+t.language.translate("Insert")+"</button></div></div>");var v="";a>=0&&(s=" fr-active",(a>l&&l>=0||a>d&&d>=0)&&(s=""),v='<div class="fr-video-upload-layer fr-layer'+s+'" id="fr-video-upload-layer-'+t.id+'"><strong>'+t.language.translate("Drop video")+"</strong><br>("+t.language.translate("or click")+')<div class="fr-form"><input type="file" accept="video/'+t.opts.videoAllowedTypes.join(", video/").toLowerCase()+'" tabIndex="-1" aria-labelledby="fr-video-upload-layer-'+t.id+'" role="button"></div></div>');var p={buttons:r,by_url_layer:n,embed_layer:f,upload_layer:v,progress_bar:'<div class="fr-video-progress-bar-layer fr-layer"><h3 tabIndex="-1" class="fr-message">Uploading</h3><div class="fr-loader"><span class="fr-progress"></span></div><div class="fr-action-buttons"><button type="button" class="fr-command fr-dismiss" data-cmd="videoDismissError" tabIndex="2" role="button">OK</button></div></div>'},u=t.popups.create("video.insert",p);return function(i){t.events.$on(i,"dragover dragenter",".fr-video-upload-layer",function(){return e(this).addClass("fr-drop"),!1},!0),t.events.$on(i,"dragleave dragend",".fr-video-upload-layer",function(){return e(this).removeClass("fr-drop"),!1},!0),t.events.$on(i,"drop",".fr-video-upload-layer",function(o){o.preventDefault(),o.stopPropagation(),e(this).removeClass("fr-drop");var r=o.originalEvent.dataTransfer;if(r&&r.files){var s=i.data("instance")||t;s.events.disableBlur(),s.video.upload(r.files),s.events.enableBlur()}},!0),t.helpers.isIOS()&&t.events.$on(i,"touchstart",'.fr-video-upload-layer input[type="file"]',function(){e(this).trigger("click")},!0),t.events.$on(i,"change",'.fr-video-upload-layer input[type="file"]',function(){if(this.files){var o=i.data("instance")||t;o.events.disableBlur(),i.find("input:focus").blur(),o.events.enableBlur(),o.video.upload(this.files)}e(this).val("")},!0)}(u),u}function s(e){t.events.focus(!0),t.selection.restore();var i=!1;V&&(F(),i=!0),t.html.insert('<span contenteditable="false" draggable="true" class="fr-jiv fr-video">'+e+"</span>",!1,t.opts.videoSplitHTML),t.popups.hide("video.insert");var o=t.$el.find(".fr-jiv");o.removeClass("fr-jiv"),O(o,t.opts.videoDefaultDisplay,t.opts.videoDefaultAlign),o.toggleClass("fr-draggable",t.opts.videoMove),t.events.trigger(i?"video.replaced":"video.inserted",[o])}function n(){var i=e(this);t.popups.hide("video.insert"),i.removeClass("fr-uploading"),i.parent().next().is("br")&&i.parent().next().remove(),v(i.parent()),t.events.trigger("video.loaded",[i.parent()])}function a(i,o,r,s,a){t.edit.off(),f("Loading video"),o&&(i=t.helpers.sanitizeURL(i)),d("Loading video"),function(){var o,d;if(s){t.undo.canDo()||s.find("video").hasClass("fr-uploading")||t.undo.saveStep();var l=s.find("video").data("fr-old-src"),f=s.data("fr-replaced");s.data("fr-replaced",!1),t.$wp?((o=s.clone()).find("video").removeData("fr-old-src").removeClass("fr-uploading"),o.find("video").off("canplay"),l&&s.find("video").attr("src",l),s.replaceWith(o)):o=s;for(var v=o.find("video").get(0).attributes,p=0;p<v.length;p++){var u=v[p];0===u.nodeName.indexOf("data-")&&o.find("video").removeAttr(u.nodeName)}if(void 0!==r)for(d in r)r.hasOwnProperty(d)&&"link"!=d&&o.find("video").attr("data-"+d,r[d]);o.find("video").on("canplay",n),o.find("video").attr("src",i),t.edit.on(),E(),t.undo.saveStep(),t.$el.blur(),t.events.trigger(f?"video.replaced":"video.inserted",[o,a])}else o=function(i,o,r){var s,n="";if(o&&void 0!==o)for(s in o)o.hasOwnProperty(s)&&"link"!=s&&(n+=" data-"+s+'="'+o[s]+'"');var a=t.opts.videoDefaultWidth;a&&"auto"!=a&&(a+="px");var d=e('<span contenteditable="false" draggable="true" class="fr-video fr-dv'+t.opts.videoDefaultDisplay[0]+("center"!=t.opts.videoDefaultAlign?" fr-fv"+t.opts.videoDefaultAlign[0]:"")+'"><video src="'+i+'" '+n+(a?' style="width: '+a+';" ':"")+" controls>"+t.language.translate("Your browser does not support HTML5 video.")+"</video></span>");d.toggleClass("fr-draggable",t.opts.videoMove),t.edit.on(),t.events.focus(!0),t.selection.restore(),t.undo.saveStep(),t.opts.videoSplitHTML?t.markers.split():t.markers.insert(),t.html.wrap();var l=t.$el.find(".fr-marker");return t.node.isLastSibling(l)&&l.parent().hasClass("fr-deletable")&&l.insertAfter(l.parent()),l.replaceWith(d),t.selection.clear(),d.find("video").get(0).readyState>d.find("video").get(0).HAVE_FUTURE_DATA||t.helpers.isIOS()?r.call(d.find("video").get(0)):d.find("video").on("canplaythrough load",r),d}(i,r,n),E(),t.undo.saveStep(),t.events.trigger("video.inserted",[o,a])}()}function d(e){var i=t.popups.get("video.insert");if(i||(i=r()),i.find(".fr-layer.fr-active").removeClass("fr-active").addClass("fr-pactive"),i.find(".fr-video-progress-bar-layer").addClass("fr-active"),i.find(".fr-buttons").hide(),V){var o=V.find("video");t.popups.setContainer("video.insert",t.$sc);var s=o.offset().left+o.width()/2,n=o.offset().top+o.height();t.popups.show("video.insert",s,n,o.outerHeight())}void 0===e&&f(t.language.translate("Uploading"),0)}function l(e){var i=t.popups.get("video.insert");if(i&&(i.find(".fr-layer.fr-pactive").addClass("fr-active").removeClass("fr-pactive"),i.find(".fr-video-progress-bar-layer").removeClass("fr-active"),i.find(".fr-buttons").show(),e||t.$el.find("video.fr-error").length)){if(t.events.focus(),t.$el.find("video.fr-error").length&&(t.$el.find("video.fr-error").parent().remove(),t.undo.saveStep(),t.undo.run(),t.undo.dropRedo()),!t.$wp&&V){var o=V;_(!0),t.selection.setAfter(o.find("video").get(0)),t.selection.restore()}t.popups.hide("video.insert")}}function f(e,i){var o=t.popups.get("video.insert");if(o){var r=o.find(".fr-video-progress-bar-layer");r.find("h3").text(e+(i?" "+i+"%":"")),r.removeClass("fr-error"),i?(r.find("div").removeClass("fr-indeterminate"),r.find("div > span").css("width",i+"%")):r.find("div").addClass("fr-indeterminate")}}function v(e){A.call(e.get(0))}function p(i){f("Loading video");var o=this.status,r=this.response,s=this.responseXML,n=this.responseText;try{if(t.opts.videoUploadToS3)if(201==o){var d=function(i){try{var o=e(i).find("Location").text(),r=e(i).find("Key").text();return!1===t.events.trigger("video.uploadedToS3",[o,r,i],!0)?(t.edit.on(),!1):o}catch(s){return D(W,i),!1}}(s);d&&a(d,!1,[],i,r||s)}else D(W,r||s);else if(o>=200&&300>o){var l=function(e){try{if(!1===t.events.trigger("video.uploaded",[e],!0))return t.edit.on(),!1;var i=JSON.parse(e);return i.link?i:(D(K,e),!1)}catch(o){return D(W,e),!1}}(n);l&&a(l.link,!1,l,i,r||n)}else D(j,r||n)}catch(v){D(W,r||n)}}function u(){D(W,this.response||this.responseText||this.responseXML)}function c(e){if(e.lengthComputable){var i=e.loaded/e.total*100|0;f(t.language.translate("Uploading"),i)}}function h(){t.edit.on(),l(!0)}function g(i){if(!t.core.sameInstance(N))return!0;i.preventDefault(),i.stopPropagation();var o=i.pageX||(i.originalEvent.touches?i.originalEvent.touches[0].pageX:null),r=i.pageY||(i.originalEvent.touches?i.originalEvent.touches[0].pageY:null);if(!o||!r)return!1;if("mousedown"==i.type){var s=t.$oel.get(0).ownerDocument,n=s.defaultView||s.parentWindow,a=!1;try{a=n.location!=n.parent.location&&!(n.$&&n.$.FE)}catch(d){}a&&n.frameElement&&(o+=t.helpers.getPX(e(n.frameElement).offset().left)+n.frameElement.clientLeft,r=i.clientY+t.helpers.getPX(e(n.frameElement).offset().top)+n.frameElement.clientTop)}t.undo.canDo()||t.undo.saveStep(),(M=e(this)).data("start-x",o),M.data("start-y",r),T.show(),t.popups.hideAll(),R()}function m(e){if(!t.core.sameInstance(N))return!0;if(M){e.preventDefault();var i=e.pageX||(e.originalEvent.touches?e.originalEvent.touches[0].pageX:null),o=e.pageY||(e.originalEvent.touches?e.originalEvent.touches[0].pageY:null);if(!i||!o)return!1;var r=M.data("start-x"),s=M.data("start-y");M.data("start-x",i),M.data("start-y",o);var n=i-r,a=o-s,d=V.find("iframe, embed, video"),l=d.width(),f=d.height();(M.hasClass("fr-hnw")||M.hasClass("fr-hsw"))&&(n=0-n),(M.hasClass("fr-hnw")||M.hasClass("fr-hne"))&&(a=0-a),d.css("width",l+n),d.css("height",f+a),d.removeAttr("width"),d.removeAttr("height"),C()}}function b(e){return t.core.sameInstance(N)?void(M&&V&&(e&&e.stopPropagation(),M=null,T.hide(),C(),o(),t.undo.saveStep())):!0}function y(e){return'<div class="fr-handler fr-h'+e+'"></div>'}function w(e,t,i,o){return e.pageX=t,e.pageY=t,g.call(this,e),e.pageX=e.pageX+i*Math.floor(Math.pow(1.1,o)),e.pageY=e.pageY+i*Math.floor(Math.pow(1.1,o)),m.call(this,e),b.call(this,e),++o}function E(){var i,o=Array.prototype.slice.call(t.el.querySelectorAll("video, .fr-video > *")),r=[];for(i=0;i<o.length;i++)r.push(o[i].getAttribute("src")),e(o[i]).toggleClass("fr-draggable",t.opts.videoMove),""===o[i].getAttribute("class")&&o[i].removeAttribute("class"),""===o[i].getAttribute("style")&&o[i].removeAttribute("style");if(Y)for(i=0;i<Y.length;i++)r.indexOf(Y[i].getAttribute("src"))<0&&t.events.trigger("video.removed",[e(Y[i])]);Y=o}function C(){N||function(){var i;if(t.shared.$video_resizer?(N=t.shared.$video_resizer,T=t.shared.$vid_overlay,t.events.on("destroy",function(){N.removeClass("fr-active").appendTo(e("body:first"))},!0)):(t.shared.$video_resizer=e('<div class="fr-video-resizer"></div>'),N=t.shared.$video_resizer,t.events.$on(N,"mousedown",function(e){e.stopPropagation()},!0),t.opts.videoResize&&(N.append(y("nw")+y("ne")+y("sw")+y("se")),t.shared.$vid_overlay=e('<div class="fr-video-overlay"></div>'),T=t.shared.$vid_overlay,i=N.get(0).ownerDocument,e(i).find("body:first").append(T))),t.events.on("shared.destroy",function(){N.html("").removeData().remove(),N=null,t.opts.videoResize&&(T.remove(),T=null)},!0),t.helpers.isMobile()||t.events.$on(e(t.o_win),"resize.video",function(){_(!0)}),t.opts.videoResize){i=N.get(0).ownerDocument,t.events.$on(N,t._mousedown,".fr-handler",g),t.events.$on(e(i),t._mousemove,m),t.events.$on(e(i.defaultView||i.parentWindow),t._mouseup,b),t.events.$on(T,"mouseleave",b);var o=1,r=null,s=0;t.events.on("keydown",function(i){if(V){var n=-1!=navigator.userAgent.indexOf("Mac OS X")?i.metaKey:i.ctrlKey,a=i.which;(a!==r||200<i.timeStamp-s)&&(o=1),(a==e.FE.KEYCODE.EQUALS||t.browser.mozilla&&a==e.FE.KEYCODE.FF_EQUALS)&&n&&!i.altKey?o=w.call(this,i,1,1,o):(a==e.FE.KEYCODE.HYPHEN||t.browser.mozilla&&a==e.FE.KEYCODE.FF_HYPHEN)&&n&&!i.altKey&&(o=w.call(this,i,2,-1,o)),r=a,s=i.timeStamp}}),t.events.on("keyup",function(){o=1})}}(),(t.$wp||t.$sc).append(N),N.data("instance",t);var i=V.find("iframe, embed, video");N.css("top",(t.opts.iframe?i.offset().top-1:i.offset().top-t.$wp.offset().top-1)+t.$wp.scrollTop()).css("left",(t.opts.iframe?i.offset().left-1:i.offset().left-t.$wp.offset().left-1)+t.$wp.scrollLeft()).css("width",i.get(0).getBoundingClientRect().width).css("height",i.get(0).getBoundingClientRect().height).addClass("fr-active")}function A(i){if(i&&"touchend"==i.type&&H)return!0;if(i&&t.edit.isDisabled())return i.stopPropagation(),i.preventDefault(),!1;if(t.edit.isDisabled())return!1;for(var r=0;r<e.FE.INSTANCES.length;r++)e.FE.INSTANCES[r]!=t&&e.FE.INSTANCES[r].events.trigger("video.hideResizer");t.toolbar.disable(),t.helpers.isMobile()&&(t.events.disableBlur(),t.$el.blur(),t.events.enableBlur()),t.$el.find(".fr-video.fr-active").removeClass("fr-active"),(V=e(this)).addClass("fr-active"),t.opts.iframe&&t.size.syncIframe(),P(),C(),o(),t.selection.clear(),t.button.bulkRefresh(),t.events.trigger("image.hideResizer")}function _(e){V&&(t.shared.vid_exit_flag||!0===e)&&(N.removeClass("fr-active"),t.toolbar.enable(),V.removeClass("fr-active"),V=null,R())}function x(){t.shared.vid_exit_flag=!0}function R(){t.shared.vid_exit_flag=!1}function S(i){var o=i.originalEvent.dataTransfer;if(o&&o.files&&o.files.length){var s=o.files[0];if(s&&s.type&&-1!==s.type.indexOf("video")){if(!t.opts.videoUpload)return i.preventDefault(),i.stopPropagation(),!1;t.markers.remove(),t.markers.insertAtPoint(i.originalEvent),t.$el.find(".fr-marker").replaceWith(e.FE.MARKERS),t.popups.hideAll();var n=t.popups.get("video.insert");return n||(n=r()),t.popups.setContainer("video.insert",t.$sc),t.popups.show("video.insert",i.originalEvent.pageX,i.originalEvent.pageY),d(),0<=t.opts.videoAllowedTypes.indexOf(s.type.replace(/video\//g,""))?U(o.files):D(G),i.preventDefault(),i.stopPropagation(),!1}}}function U(e){if(void 0!==e&&0<e.length){if(!1===t.events.trigger("video.beforeUpload",[e]))return!1;var i,o=e[0];if((null===t.opts.videoUploadURL||t.opts.videoUploadURL==X)&&!t.opts.videoUploadToS3)return f=o,(v=new FileReader).addEventListener("load",function(){v.result;for(var e=atob(v.result.split(",")[1]),t=[],i=0;i<e.length;i++)t.push(e.charCodeAt(i));a(window.URL.createObjectURL(new Blob([new Uint8Array(t)],{type:f.type})),!1,null,V)},!1),d(),v.readAsDataURL(f),!1;if(o.size>t.opts.videoMaxSize)return D(q),!1;if(t.opts.videoAllowedTypes.indexOf(o.type.replace(/video\//g,""))<0)return D(G),!1;if(t.drag_support.formdata&&(i=t.drag_support.formdata?new FormData:null),i){var r;if(!1!==t.opts.videoUploadToS3)for(r in i.append("key",t.opts.videoUploadToS3.keyStart+(new Date).getTime()+"-"+(o.name||"untitled")),i.append("success_action_status","201"),i.append("X-Requested-With","xhr"),i.append("Content-Type",o.type),t.opts.videoUploadToS3.params)t.opts.videoUploadToS3.params.hasOwnProperty(r)&&i.append(r,t.opts.videoUploadToS3.params[r]);for(r in t.opts.videoUploadParams)t.opts.videoUploadParams.hasOwnProperty(r)&&i.append(r,t.opts.videoUploadParams[r]);i.append(t.opts.videoUploadParam,o);var s=t.opts.videoUploadURL;t.opts.videoUploadToS3&&(s=t.opts.videoUploadToS3.uploadURL?t.opts.videoUploadToS3.uploadURL:"https://"+t.opts.videoUploadToS3.region+".amazonaws.com/"+t.opts.videoUploadToS3.bucket);var n=t.core.getXHR(s,t.opts.videoUploadMethod);n.onload=function(){p.call(n,V)},n.onerror=u,n.upload.onprogress=c,n.onabort=h,d(),t.events.disableBlur(),t.edit.off(),t.events.enableBlur();var l=t.popups.get("video.insert");l&&l.off("abortUpload").on("abortUpload",function(){4!=n.readyState&&n.abort()}),n.send(i)}}var f,v}function D(e,i){t.edit.on(),V&&V.find("video").addClass("fr-error"),function(e){d();var i=t.popups.get("video.insert").find(".fr-video-progress-bar-layer");i.addClass("fr-error");var o=i.find("h3");o.text(e),t.events.disableBlur(),o.focus()}(t.language.translate("Something went wrong. Please try again.")),t.events.trigger("video.error",[{code:e,message:Z[e]},i])}function I(){if(V){var e=t.popups.get("video.size"),i=V.find("iframe, embed, video");e.find('input[name="width"]').val(i.get(0).style.width||i.attr("width")).trigger("change"),e.find('input[name="height"]').val(i.get(0).style.height||i.attr("height")).trigger("change")}}function B(e){if(e)return t.popups.onRefresh("video.size",I),!0;var i={buttons:'<div class="fr-buttons">'+t.button.buildList(t.opts.videoSizeButtons)+"</div>",size_layer:'<div class="fr-video-size-layer fr-layer fr-active" id="fr-video-size-layer-'+t.id+'"><div class="fr-video-group"><div class="fr-input-line"><input id="fr-video-size-layer-width-'+t.id+'" type="text" name="width" placeholder="'+t.language.translate("Width")+'" tabIndex="1"></div><div class="fr-input-line"><input id="fr-video-size-layer-height-'+t.id+'" type="text" name="height" placeholder="'+t.language.translate("Height")+'" tabIndex="1"></div></div><div class="fr-action-buttons"><button type="button" class="fr-command fr-submit" data-cmd="videoSetSize" tabIndex="2" role="button">'+t.language.translate("Update")+"</button></div></div>"},o=t.popups.create("video.size",i);return t.events.$on(t.$wp,"scroll",function(){V&&t.popups.isVisible("video.size")&&(t.events.disableBlur(),v(V))}),o}function $(e){if(void 0===e&&(e=V),e){if(e.hasClass("fr-fvl"))return"left";if(e.hasClass("fr-fvr"))return"right";if(e.hasClass("fr-dvb")||e.hasClass("fr-dvi"))return"center";if("block"==e.css("display")){if("left"==e.css("text-algin"))return"left";if("right"==e.css("text-align"))return"right"}else{if("left"==e.css("float"))return"left";if("right"==e.css("float"))return"right"}}return"center"}function k(e){void 0===e&&(e=V);var t=e.css("float");return e.css("float","none"),"block"==e.css("display")?(e.css("float",""),e.css("float")!=t&&e.css("float",t),"block"):(e.css("float",""),e.css("float")!=t&&e.css("float",t),"inline")}function F(){if(V&&!1!==t.events.trigger("video.beforeRemove",[V])){var e=V;t.popups.hideAll(),_(!0),t.selection.setBefore(e.get(0))||t.selection.setAfter(e.get(0)),e.remove(),t.selection.restore(),t.html.fillEmptyBlocks(),t.events.trigger("video.removed",[e])}}function L(){l()}function O(e,i,o){!t.opts.htmlUntouched&&t.opts.useClasses?(e.removeClass("fr-fvl fr-fvr fr-dvb fr-dvi"),e.addClass("fr-fv"+o[0]+" fr-dv"+i[0])):"inline"==i?(e.css({display:"inline-block"}),"center"==o?e.css({"float":"none"}):"left"==o?e.css({"float":"left"}):e.css({"float":"right"})):(e.css({display:"block",clear:"both"}),"left"==o?e.css({textAlign:"left"}):"right"==o?e.css({textAlign:"right"}):e.css({textAlign:"center"}))}function z(){t.$el.find("video").filter(function(){return 0===e(this).parents("span.fr-video").length}).wrap('<span class="fr-video" contenteditable="false"></span>'),t.$el.find("embed, iframe").filter(function(){if(t.browser.safari&&this.getAttribute("src")&&this.setAttribute("src",this.src),0<e(this).parents("span.fr-video").length)return!1;for(var i=e(this).attr("src"),o=0;o<e.FE.VIDEO_PROVIDERS.length;o++){var r=e.FE.VIDEO_PROVIDERS[o];if(r.test_regex.test(i)&&new RegExp(t.opts.videoAllowedProviders.join("|")).test(r.provider))return!0}return!1}).map(function(){return 0===e(this).parents("object").length?this:e(this).parents("object").get(0)}).wrap('<span class="fr-video" contenteditable="false"></span>');for(var i,o,r=t.$el.find("span.fr-video, video"),s=0;s<r.length;s++){var n=e(r[s]);!t.opts.htmlUntouched&&t.opts.useClasses?((o=n).hasClass("fr-dvi")||o.hasClass("fr-dvb")||(o.addClass("fr-fv"+$(o)[0]),o.addClass("fr-dv"+k(o)[0])),t.opts.videoTextNear||n.removeClass("fr-dvi").addClass("fr-dvb")):t.opts.htmlUntouched||t.opts.useClasses||(O(i=n,i.hasClass("fr-dvb")?"block":i.hasClass("fr-dvi")?"inline":null,i.hasClass("fr-fvl")?"left":i.hasClass("fr-fvr")?"right":$(i)),i.removeClass("fr-dvb fr-dvi fr-fvr fr-fvl"))}r.toggleClass("fr-draggable",t.opts.videoMove)}function P(){if(V){t.selection.clear();var e=t.doc.createRange();e.selectNode(V.get(0)),t.selection.get().addRange(e)}}var T,M,N,V,Y,H,X="https://i.froala.com/upload",K=2,j=3,W=4,q=5,G=6,Z={};return Z[1]="Video cannot be loaded from the passed link.",Z[K]="No link in upload response.",Z[j]="Error during file upload.",Z[W]="Parsing response failed.",Z[q]="File is too large.",Z[G]="Video file type is invalid.",Z[7]="Files can be uploaded only to same domain in IE 8 and IE 9.",t.shared.vid_exit_flag=!1,{_init:function(){t.events.on("drop",S,!0),t.events.on("mousedown window.mousedown",x),t.events.on("window.touchmove",R),t.events.on("mouseup window.mouseup",_),t.events.on("commands.mousedown",function(e){0<e.parents(".fr-toolbar").length&&_()}),t.events.on("video.hideResizer commands.undo commands.redo element.dropped",function(){_(!0)}),t.helpers.isMobile()&&(t.events.$on(t.$el,"touchstart","span.fr-video",function(){H=!1}),t.events.$on(t.$el,"touchmove",function(){H=!0})),t.events.on("html.set",z),z(),t.events.$on(t.$el,"mousedown","span.fr-video",function(e){e.stopPropagation()}),t.events.$on(t.$el,"click touchend","span.fr-video",function(t){return"false"==e(this).parents("[contenteditable]:not(.fr-element):not(.fr-img-caption):not(body):first").attr("contenteditable")?!0:void A.call(this,t)}),t.events.on("keydown",function(i){var o=i.which;return!V||o!=e.FE.KEYCODE.BACKSPACE&&o!=e.FE.KEYCODE.DELETE?V&&o==e.FE.KEYCODE.ESC?(_(!0),i.preventDefault(),!1):V&&o!=e.FE.KEYCODE.F10&&!t.keys.isBrowserAction(i)?(i.preventDefault(),!1):void 0:(i.preventDefault(),F(),t.undo.saveStep(),!1)},!0),t.events.on("toolbar.esc",function(){return V?(t.events.disableBlur(),t.events.focus(),!1):void 0},!0),t.events.on("toolbar.focusEditor",function(){return V?!1:void 0},!0),t.events.on("keydown",function(){t.$el.find("span.fr-video:empty").remove()}),t.$wp&&(E(),t.events.on("contentChanged",E)),r(!0),B(!0)},showInsertPopup:function(){var e=t.$tb.find('.fr-command[data-cmd="insertVideo"]'),i=t.popups.get("video.insert");if(i||(i=r()),l(),!i.hasClass("fr-active"))if(t.popups.refresh("video.insert"),t.popups.setContainer("video.insert",t.$tb),e.is(":visible")){var o=e.offset().left+e.outerWidth()/2,s=e.offset().top+(t.opts.toolbarBottom?10:e.outerHeight()-10);t.popups.show("video.insert",o,s,e.outerHeight())}else t.position.forSelection(i),t.popups.show("video.insert")},showLayer:function(e){var i,o,r=t.popups.get("video.insert");if(!V&&!t.opts.toolbarInline){var s=t.$tb.find('.fr-command[data-cmd="insertVideo"]');i=s.offset().left+s.outerWidth()/2,o=s.offset().top+(t.opts.toolbarBottom?10:s.outerHeight()-10)}t.opts.toolbarInline&&(o=r.offset().top-t.helpers.getPX(r.css("margin-top")),r.hasClass("fr-above")&&(o+=r.outerHeight())),r.find(".fr-layer").removeClass("fr-active"),r.find(".fr-"+e+"-layer").addClass("fr-active"),t.popups.show("video.insert",i,o,0),t.accessibility.focusPopup(r)},refreshByURLButton:function(e){t.popups.get("video.insert").find(".fr-video-by-url-layer").hasClass("fr-active")&&e.addClass("fr-active").attr("aria-pressed",!0)},refreshEmbedButton:function(e){t.popups.get("video.insert").find(".fr-video-embed-layer").hasClass("fr-active")&&e.addClass("fr-active").attr("aria-pressed",!0)},refreshUploadButton:function(e){t.popups.get("video.insert").find(".fr-video-upload-layer").hasClass("fr-active")&&e.addClass("fr-active").attr("aria-pressed",!0)},upload:U,insertByURL:function(i){void 0===i&&(i=(t.popups.get("video.insert").find('.fr-video-by-url-layer input[type="text"]').val()||"").trim());var o=null;if(/^http/.test(i)||(i="https://"+i),t.helpers.isURL(i))for(var r=0;r<e.FE.VIDEO_PROVIDERS.length;r++){var n=e.FE.VIDEO_PROVIDERS[r];if(n.test_regex.test(i)&&new RegExp(t.opts.videoAllowedProviders.join("|")).test(n.provider)){o=i.replace(n.url_regex,n.url_text),o=n.html.replace(/\{url\}/,o);break}}o?s(o):t.events.trigger("video.linkError",[i])},insertEmbed:function(i){void 0===i&&(i=t.popups.get("video.insert").find(".fr-video-embed-layer textarea").val()||""),0!==i.length&&e.FE.VIDEO_EMBED_REGEX.test(i)?s(i):t.events.trigger("video.codeError",[i])},insert:s,align:function(e){V.removeClass("fr-fvr fr-fvl"),!t.opts.htmlUntouched&&t.opts.useClasses?"left"==e?V.addClass("fr-fvl"):"right"==e&&V.addClass("fr-fvr"):O(V,k(),e),P(),C(),o(),t.selection.clear()},refreshAlign:function(e){return V?void e.find("> *:first").replaceWith(t.icon.create("video-align-"+$())):!1},refreshAlignOnShow:function(e,t){V&&t.find('.fr-command[data-param1="'+$()+'"]').addClass("fr-active").attr("aria-selected",!0)},display:function(e){V.removeClass("fr-dvi fr-dvb"),!t.opts.htmlUntouched&&t.opts.useClasses?"inline"==e?V.addClass("fr-dvi"):"block"==e&&V.addClass("fr-dvb"):O(V,e,$()),P(),C(),o(),t.selection.clear()},refreshDisplayOnShow:function(e,t){V&&t.find('.fr-command[data-param1="'+k()+'"]').addClass("fr-active").attr("aria-selected",!0)},remove:F,hideProgressBar:l,showSizePopup:function(){var e=t.popups.get("video.size");e||(e=B()),l(),t.popups.refresh("video.size"),t.popups.setContainer("video.size",t.$sc);var i=V.find("iframe, embed, video"),o=i.offset().left+i.width()/2,r=i.offset().top+i.height();t.popups.show("video.size",o,r,i.height())},replace:function(){var e=t.popups.get("video.insert");e||(e=r()),t.popups.isVisible("video.insert")||(l(),t.popups.refresh("video.insert"),t.popups.setContainer("video.insert",t.$sc));var i=V.offset().left+V.width()/2,o=V.offset().top+V.height();t.popups.show("video.insert",i,o,V.outerHeight())},back:function(){V?(t.events.disableBlur(),V.trigger("click")):(t.events.disableBlur(),t.selection.restore(),t.events.enableBlur(),t.popups.hide("video.insert"),t.toolbar.showInline())},setSize:function(e,i){if(V){var o=t.popups.get("video.size"),r=V.find("iframe, embed, video");r.css("width",e||o.find('input[name="width"]').val()),r.css("height",i||o.find('input[name="height"]').val()),r.get(0).style.width&&r.removeAttr("width"),r.get(0).style.height&&r.removeAttr("height"),o.find("input:focus").blur(),setTimeout(function(){V.trigger("click")},t.helpers.isAndroid()?50:0)}},get:function(){return V}}},e.FE.RegisterCommand("insertVideo",{title:"Insert Video",undo:!1,focus:!0,refreshAfterCallback:!1,popup:!0,callback:function(){this.popups.isVisible("video.insert")?(this.$el.find(".fr-marker").length&&(this.events.disableBlur(),this.selection.restore()),this.popups.hide("video.insert")):this.video.showInsertPopup()},plugin:"video"}),e.FE.DefineIcon("insertVideo",{NAME:"video-camera",FA5NAME:"camera"}),e.FE.DefineIcon("videoByURL",{NAME:"link"}),e.FE.RegisterCommand("videoByURL",{title:"By URL",undo:!1,focus:!1,toggle:!0,callback:function(){this.video.showLayer("video-by-url")},refresh:function(e){this.video.refreshByURLButton(e)}}),e.FE.DefineIcon("videoEmbed",{NAME:"code"}),e.FE.RegisterCommand("videoEmbed",{title:"Embedded Code",undo:!1,focus:!1,toggle:!0,callback:function(){this.video.showLayer("video-embed")},refresh:function(e){this.video.refreshEmbedButton(e)}}),e.FE.DefineIcon("videoUpload",{NAME:"upload"}),e.FE.RegisterCommand("videoUpload",{title:"Upload Video",undo:!1,focus:!1,toggle:!0,callback:function(){this.video.showLayer("video-upload")},refresh:function(e){this.video.refreshUploadButton(e)}}),e.FE.RegisterCommand("videoInsertByURL",{undo:!0,focus:!0,callback:function(){this.video.insertByURL()}}),e.FE.RegisterCommand("videoInsertEmbed",{undo:!0,focus:!0,callback:function(){this.video.insertEmbed()}}),e.FE.DefineIcon("videoDisplay",{NAME:"star"}),e.FE.RegisterCommand("videoDisplay",{title:"Display",type:"dropdown",options:{inline:"Inline",block:"Break Text"},callback:function(e,t){this.video.display(t)},refresh:function(e){this.opts.videoTextNear||e.addClass("fr-hidden")},refreshOnShow:function(e,t){this.video.refreshDisplayOnShow(e,t)}}),e.FE.DefineIcon("video-align",{NAME:"align-left"}),e.FE.DefineIcon("video-align-left",{NAME:"align-left"}),e.FE.DefineIcon("video-align-right",{NAME:"align-right"}),e.FE.DefineIcon("video-align-center",{NAME:"align-justify"}),e.FE.DefineIcon("videoAlign",{NAME:"align-center"}),e.FE.RegisterCommand("videoAlign",{type:"dropdown",title:"Align",options:{left:"Align Left",center:"None",right:"Align Right"},html:function(){var t='<ul class="fr-dropdown-list" role="presentation">',i=e.FE.COMMANDS.videoAlign.options;for(var o in i)i.hasOwnProperty(o)&&(t+='<li role="presentation"><a class="fr-command fr-title" tabIndex="-1" role="option" data-cmd="videoAlign" data-param1="'+o+'" title="'+this.language.translate(i[o])+'">'+this.icon.create("video-align-"+o)+'<span class="fr-sr-only">'+this.language.translate(i[o])+"</span></a></li>");return t+="</ul>"},callback:function(e,t){this.video.align(t)},refresh:function(e){this.video.refreshAlign(e)},refreshOnShow:function(e,t){this.video.refreshAlignOnShow(e,t)}}),e.FE.DefineIcon("videoReplace",{NAME:"exchange",FA5NAME:"exchange-alt"}),e.FE.RegisterCommand("videoReplace",{title:"Replace",
undo:!1,focus:!1,popup:!0,refreshAfterCallback:!1,callback:function(){this.video.replace()}}),e.FE.DefineIcon("videoRemove",{NAME:"trash"}),e.FE.RegisterCommand("videoRemove",{title:"Remove",callback:function(){this.video.remove()}}),e.FE.DefineIcon("videoSize",{NAME:"arrows-alt"}),e.FE.RegisterCommand("videoSize",{undo:!1,focus:!1,popup:!0,title:"Change Size",callback:function(){this.video.showSizePopup()}}),e.FE.DefineIcon("videoBack",{NAME:"arrow-left"}),e.FE.RegisterCommand("videoBack",{title:"Back",undo:!1,focus:!1,back:!0,callback:function(){this.video.back()},refresh:function(e){this.video.get()||this.opts.toolbarInline?(e.removeClass("fr-hidden"),e.next(".fr-separator").removeClass("fr-hidden")):(e.addClass("fr-hidden"),e.next(".fr-separator").addClass("fr-hidden"))}}),e.FE.RegisterCommand("videoDismissError",{title:"OK",undo:!1,callback:function(){this.video.hideProgressBar(!0)}}),e.FE.RegisterCommand("videoSetSize",{undo:!0,focus:!1,title:"Update",refreshAfterCallback:!1,callback:function(){this.video.setSize()}})});