!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(require("froala-editor")):"function"==typeof define&&define.amd?define(["froala-editor"],t):t(e.FroalaEditor)}(this,function(me){"use strict";me=me&&me.hasOwnProperty("default")?me["default"]:me,Object.assign(me.POPUP_TEMPLATES,{"table.insert":"[_BUTTONS_][_ROWS_COLUMNS_]","table.edit":"[_BUTTONS_]","table.colors":"[_BUTTONS_][_COLORS_][_CUSTOM_COLOR_]"}),Object.assign(me.DEFAULTS,{tableInsertMaxSize:10,tableEditButtons:["tableHeader","tableRemove","tableRows","tableColumns","tableStyle","-","tableCells","tableCellBackground","tableCellVerticalAlign","tableCellHorizontalAlign","tableCellStyle"],tableInsertButtons:["tableBack","|"],tableResizer:!0,tableDefaultWidth:"100%",tableResizerOffset:5,tableResizingLimit:30,tableColorsButtons:["tableBack","|"],tableColors:["#61BD6D","#1ABC9C","#54ACD2","#2C82C9","#9365B8","#475577","#CCCCCC","#41A85F","#00A885","#3D8EB9","#2969B0","#553982","#28324E","#000000","#F7DA64","#FBA026","#EB6B56","#E25041","#A38F84","#EFEFEF","#FFFFFF","#FAC51C","#F37934","#D14841","#B8312F","#7C706B","#D1D5D8","REMOVE"],tableColorsStep:7,tableCellStyles:{"fr-highlighted":"Highlighted","fr-thick":"Thick"},tableStyles:{"fr-dashed-borders":"Dashed Borders","fr-alternate-rows":"Alternate Rows"},tableCellMultipleStyles:!0,tableMultipleStyles:!0,tableInsertHelper:!0,tableInsertHelperOffset:15}),me.PLUGINS.table=function(R){function h(){var e=O();if(e){var t=R.popups.get("table.edit");if(t||(t=r()),t){R.popups.setContainer("table.edit",R.$sc);var a=f(e),l=a.left+(a.right-a.left)/2,n=a.bottom;R.popups.show("table.edit",l,n,a.bottom-a.top,!0),R.edit.isDisabled()&&(1<V().length&&R.toolbar.disable(),R.$el.removeClass("fr-no-selection"),R.edit.on(),R.button.bulkRefresh(),R.selection.setAtEnd(R.$el.find(".fr-selected-cell").last().get(0)),R.selection.restore())}}}function s(){var e=O();if(e){var t=R.popups.get("table.colors");t||(t=function r(){var e="";0<R.opts.tableColorsButtons.length&&(e='<div class="fr-buttons fr-tabs">'.concat(R.button.buildList(R.opts.tableColorsButtons),"</div>"));var t="";R.opts.colorsHEXInput&&(t='<div class="fr-color-hex-layer fr-table-colors-hex-layer fr-active fr-layer" id="fr-table-colors-hex-layer-'.concat(R.id,'"><div class="fr-input-line"><input maxlength="7" id="fr-table-colors-hex-layer-text-').concat(R.id,'" type="text" placeholder="').concat(R.language.translate("HEX Color"),'" tabIndex="1" aria-required="true"></div><div class="fr-action-buttons"><button type="button" class="fr-command fr-submit" data-cmd="tableCellBackgroundCustomColor" tabIndex="2" role="button">').concat(R.language.translate("OK"),"</button></div></div>"));var a={buttons:e,colors:function n(){for(var e='<div class="fr-color-set fr-table-colors">',t=0;t<R.opts.tableColors.length;t++)0!==t&&t%R.opts.tableColorsStep==0&&(e+="<br>"),"REMOVE"!=R.opts.tableColors[t]?e+='<span class="fr-command" style="background: '.concat(R.opts.tableColors[t],';" tabIndex="-1" role="button" data-cmd="tableCellBackgroundColor" data-param1="').concat(R.opts.tableColors[t],'"><span class="fr-sr-only">').concat(R.language.translate("Color")," ").concat(R.opts.tableColors[t],"&nbsp;&nbsp;&nbsp;</span></span>"):e+='<span class="fr-command" data-cmd="tableCellBackgroundColor" tabIndex="-1" role="button" data-param1="REMOVE" title="'.concat(R.language.translate("Clear Formatting"),'">').concat(R.icon.create("tableColorRemove"),'<span class="fr-sr-only">').concat(R.language.translate("Clear Formatting"),"</span></span>");return e+"</div>"}(),custom_color:t},l=R.popups.create("table.colors",a);return R.events.$on(R.$wp,"scroll.table-colors",function(){R.popups.isVisible("table.colors")&&s()}),function o(h){R.events.on("popup.tab",function(e){var t=ee(e.currentTarget);if(!R.popups.isVisible("table.colors")||!t.is("span"))return!0;var a=e.which,l=!0;if(me.KEYCODE.TAB==a){var n=h.find(".fr-buttons");l=!R.accessibility.focusToolbar(n,!!e.shiftKey)}else if(me.KEYCODE.ARROW_UP==a||me.KEYCODE.ARROW_DOWN==a||me.KEYCODE.ARROW_LEFT==a||me.KEYCODE.ARROW_RIGHT==a){var o=t.parent().find("span.fr-command"),r=o.index(t),s=R.opts.colorsStep,i=Math.floor(o.length/s),f=r%s,c=Math.floor(r/s)*s+f,d=i*s;me.KEYCODE.ARROW_UP==a?c=((c-s)%d+d)%d:me.KEYCODE.ARROW_DOWN==a?c=(c+s)%d:me.KEYCODE.ARROW_LEFT==a?c=((c-1)%d+d)%d:me.KEYCODE.ARROW_RIGHT==a&&(c=(c+1)%d);var p=ee(o.get(c));R.events.disableBlur(),p.focus(),l=!1}else me.KEYCODE.ENTER==a&&(R.button.exec(t),l=!1);return!1===l&&(e.preventDefault(),e.stopPropagation()),l},!0)}(l),l}()),R.popups.setContainer("table.colors",R.$sc);var a=f(e),l=(a.left+a.right)/2,n=a.bottom;!function o(){var e=R.popups.get("table.colors"),t=R.$el.find(".fr-selected-cell").first(),a=R.helpers.RGBToHex(t.css("background-color")),l=e.find(".fr-table-colors-hex-layer input");e.find(".fr-selected-color").removeClass("fr-selected-color fr-active-item"),e.find('span[data-param1="'.concat(a,'"]')).addClass("fr-selected-color fr-active-item"),l.val(a).trigger("change")}(),R.popups.show("table.colors",l,n,a.bottom-a.top,!0)}}function l(){0===V().length&&R.toolbar.enable()}function o(e){if(e)return R.popups.onHide("table.insert",function(){R.popups.get("table.insert").find('.fr-table-size .fr-select-table-size > span[data-row="1"][data-col="1"]').trigger("mouseover")}),!0;var t="";0<R.opts.tableInsertButtons.length&&(t='<div class="fr-buttons fr-tabs">'.concat(R.button.buildList(R.opts.tableInsertButtons),"</div>"));var a={buttons:t,rows_columns:function o(){for(var e='<div class="fr-table-size"><div class="fr-table-size-info">1 &times; 1</div><div class="fr-select-table-size">',t=1;t<=R.opts.tableInsertMaxSize;t++){for(var a=1;a<=R.opts.tableInsertMaxSize;a++){var l="inline-block";2<t&&!R.helpers.isMobile()&&(l="none");var n="fr-table-cell ";1==t&&1==a&&(n+=" hover"),e+='<span class="fr-command '.concat(n,'" tabIndex="-1" data-cmd="tableInsert" data-row="').concat(t,'" data-col="').concat(a,'" data-param1="').concat(t,'" data-param2="').concat(a,'" style="display: ').concat(l,';" role="button"><span></span><span class="fr-sr-only">').concat(t," &times; ").concat(a,"&nbsp;&nbsp;&nbsp;</span></span>")}e+='<div class="new-line"></div>'}return e+"</div></div>"}()},l=R.popups.create("table.insert",a);return R.events.$on(l,"mouseover",".fr-table-size .fr-select-table-size .fr-table-cell",function(e){d(ee(e.currentTarget))},!0),function n(e){R.events.$on(e,"focus","[tabIndex]",function(e){d(ee(e.currentTarget))}),R.events.on("popup.tab",function(e){var t=ee(e.currentTarget);if(!R.popups.isVisible("table.insert")||!t.is("span, a"))return!0;var a,l=e.which;if(me.KEYCODE.ARROW_UP==l||me.KEYCODE.ARROW_DOWN==l||me.KEYCODE.ARROW_LEFT==l||me.KEYCODE.ARROW_RIGHT==l){if(t.is("span.fr-table-cell")){var n=t.parent().find("span.fr-table-cell"),o=n.index(t),r=R.opts.tableInsertMaxSize,s=o%r,i=Math.floor(o/r);me.KEYCODE.ARROW_UP==l?i=Math.max(0,i-1):me.KEYCODE.ARROW_DOWN==l?i=Math.min(R.opts.tableInsertMaxSize-1,i+1):me.KEYCODE.ARROW_LEFT==l?s=Math.max(0,s-1):me.KEYCODE.ARROW_RIGHT==l&&(s=Math.min(R.opts.tableInsertMaxSize-1,s+1));var f=i*r+s,c=ee(n.get(f));d(c),R.events.disableBlur(),c.focus(),a=!1}}else me.KEYCODE.ENTER==l&&(R.button.exec(t),a=!1);return!1===a&&(e.preventDefault(),e.stopPropagation()),a},!0)}(l),l}function d(e){var t=e.data("row");null!==t&&(t=parseInt(t));var a=e.data("col");null!==a&&(a=parseInt(a));var l=e.parent();l.siblings(".fr-table-size-info").html("".concat(t," &times; ").concat(a)),l.find("> span").removeClass("hover fr-active-item");for(var n=1;n<=R.opts.tableInsertMaxSize;n++)for(var o=0;o<=R.opts.tableInsertMaxSize;o++){var r=l.find('> span[data-row="'.concat(n,'"][data-col="').concat(o,'"]'));n<=t&&o<=a?r.addClass("hover"):n<=t+1||n<=2&&!R.helpers.isMobile()?r.css("display","inline-block"):2<n&&!R.helpers.isMobile()&&r.css("display","none")}e.addClass("fr-active-item")}function r(e){if(e)return R.popups.onHide("table.edit",l),!0;if(0<R.opts.tableEditButtons.length){var t={buttons:'<div class="fr-buttons">'.concat(R.button.buildList(R.opts.tableEditButtons),"</div>")},a=R.popups.create("table.edit",t);return R.events.$on(R.$wp,"scroll.table-edit",function(){R.popups.isVisible("table.edit")&&h()}),a}return!1}function p(){if(0<V().length){var e=P();R.selection.setBefore(e.get(0))||R.selection.setAfter(e.get(0)),R.selection.restore(),R.popups.hide("table.edit"),e.remove(),R.toolbar.enable()}}function i(e){var t=P();if(0<t.length){if(0<R.$el.find("th.fr-selected-cell").length&&"above"==e)return;var a,l,n,o=O(),r=w(o);if(null==r)return;l="above"==e?r.min_i:r.max_i;var s="<tr>";for(a=0;a<o[l].length;a++)if("below"==e&&l<o.length-1&&o[l][a]==o[l+1][a]||"above"==e&&0<l&&o[l][a]==o[l-1][a]){if(0===a||0<a&&o[l][a]!=o[l][a-1]){var i=ee(o[l][a]);i.attr("rowspan",parseInt(i.attr("rowspan"),10)+1)}}else s+='<td style="'+ee(o[l][a]).attr("style")+'" ><br></td>';s+="</tr>",n=0<R.$el.find("th.fr-selected-cell").length&&"below"==e?ee(t.find("tbody").not(t.find("> table tbody"))):ee(t.find("tr").not(t.find("> table tr")).get(l)),"below"==e?"TBODY"==n.attr("tagName")?n.prepend(s):n[0].parentNode&&n[0].insertAdjacentHTML("afterend",s):"above"==e&&(n.before(s),R.popups.isVisible("table.edit")&&h())}}function c(e,t,a){var l,n,o,r,s,i=0,f=O(a);if(e<(t=Math.min(t,f[0].length-1)))for(n=e;n<=t;n++)if(!(e<n&&f[0][n]==f[0][n-1])&&1<(r=Math.min(parseInt(f[0][n].getAttribute("colspan"),10)||1,t-e+1))&&f[0][n]==f[0][n+1])for(i=r-1,l=1;l<f.length;l++)if(f[l][n]!=f[l-1][n]){for(o=n;o<n+r;o++)if(1<(s=parseInt(f[l][o].getAttribute("colspan"),10)||1)&&f[l][o]==f[l][o+1])o+=i=Math.min(i,s-1);else if(!(i=Math.max(0,i-1)))break;if(!i)break}i&&b(f,i,"colspan",0,f.length-1,e,t)}function u(e,t,a){var l,n,o,r,s,i=0,f=O(a);if(e<(t=Math.min(t,f.length-1)))for(l=e;l<=t;l++)if(!(e<l&&f[l][0]==f[l-1][0])&&1<(r=Math.min(parseInt(f[l][0].getAttribute("rowspan"),10)||1,t-e+1))&&f[l][0]==f[l+1][0])for(i=r-1,n=1;n<f[0].length;n++)if(f[l][n]!=f[l][n-1]){for(o=l;o<l+r;o++)if(1<(s=parseInt(f[o][n].getAttribute("rowspan"),10)||1)&&f[o][n]==f[o+1][n])o+=i=Math.min(i,s-1);else if(!(i=Math.max(0,i-1)))break;if(!i)break}i&&b(f,i,"rowspan",e,t,0,f[0].length-1)}function b(e,t,a,l,n,o,r){var s,i,f;for(s=l;s<=n;s++)for(i=o;i<=r;i++)l<s&&e[s][i]==e[s-1][i]||o<i&&e[s][i]==e[s][i-1]||1<(f=parseInt(e[s][i].getAttribute(a),10)||1)&&(1<f-t?e[s][i].setAttribute(a,f-t):e[s][i].removeAttribute(a))}function g(e,t,a,l,n){u(e,t,n),c(a,l,n)}function t(e){var t=R.$el.find(".fr-selected-cell");"REMOVE"!=e?t.css("background-color",R.helpers.HEXtoRGB(e)):t.css("background-color",""),h()}function O(e){var f=[];return null==(e=e||null)&&0<V().length&&(e=P()),e&&e.findVisible("tr").not(e.find("> table tr")).each(function(s,e){var t=ee(e),i=0;t.find("> th, > td").each(function(e,t){for(var a=ee(t),l=parseInt(a.attr("colspan"),10)||1,n=parseInt(a.attr("rowspan"),10)||1,o=s;o<s+n;o++)for(var r=i;r<i+l;r++)f[o]||(f[o]=[]),f[o][r]?i++:f[o][r]=t;i+=l})}),f}function A(e,t){for(var a=0;a<t.length;a++)for(var l=0;l<t[a].length;l++)if(t[a][l]==e)return{row:a,col:l}}function x(e,t,a){for(var l=e+1,n=t+1;l<a.length;){if(a[l][t]!=a[e][t]){l--;break}l++}for(l==a.length&&l--;n<a[e].length;){if(a[e][n]!=a[e][t]){n--;break}n++}return n==a[e].length&&n--,{row:l,col:n}}function m(){R.el.querySelector(".fr-cell-fixed")&&R.el.querySelector(".fr-cell-fixed").classList.remove("fr-cell-fixed"),R.el.querySelector(".fr-cell-handler")&&R.el.querySelector(".fr-cell-handler").classList.remove("fr-cell-handler")}function v(){var e=R.$el.find(".fr-selected-cell");0<e.length&&e.each(function(){var e=ee(this);e.removeClass("fr-selected-cell"),""===e.attr("class")&&e.removeAttr("class")}),m()}function _(){R.events.disableBlur(),R.selection.clear(),R.$el.addClass("fr-no-selection"),R.$el.blur(),R.events.enableBlur()}function w(e){var t=R.$el.find(".fr-selected-cell");if(0<t.length){var a,l=e.length,n=0,o=e[0].length,r=0;for(a=0;a<t.length;a++){var s=A(t[a],e),i=x(s.row,s.col,e);l=Math.min(s.row,l),n=Math.max(i.row,n),o=Math.min(s.col,o),r=Math.max(i.col,r)}return{min_i:l,max_i:n,min_j:o,max_j:r}}return null}function f(e){var t=w(e);if(null!=t){var a=ee(e[t.min_i][t.min_j]),l=ee(e[t.min_i][t.max_j]),n=ee(e[t.max_i][t.min_j]);return{left:a.length&&a.offset().left,right:l.length&&l.offset().left+l.outerWidth(),top:a.length&&a.offset().top,bottom:n.length&&n.offset().top+n.outerHeight()}}}function C(e,t){if(ee(e).is(t))v(),ee(e).addClass("fr-selected-cell");else{_(),R.edit.off();var a=O(),l=A(e,a),n=A(t,a),o=function h(e,t,a,l,n){var o,r,s,i,f=e,c=t,d=a,p=l;for(o=f;o<=c;o++)(1<(parseInt(ee(n[o][d]).attr("rowspan"),10)||1)||1<(parseInt(ee(n[o][d]).attr("colspan"),10)||1))&&(i=x((s=A(n[o][d],n)).row,s.col,n),f=Math.min(s.row,f),c=Math.max(i.row,c),d=Math.min(s.col,d),p=Math.max(i.col,p)),(1<(parseInt(ee(n[o][p]).attr("rowspan"),10)||1)||1<(parseInt(ee(n[o][p]).attr("colspan"),10)||1))&&(i=x((s=A(n[o][p],n)).row,s.col,n),f=Math.min(s.row,f),c=Math.max(i.row,c),d=Math.min(s.col,d),p=Math.max(i.col,p));for(r=d;r<=p;r++)(1<(parseInt(ee(n[f][r]).attr("rowspan"),10)||1)||1<(parseInt(ee(n[f][r]).attr("colspan"),10)||1))&&(i=x((s=A(n[f][r],n)).row,s.col,n),f=Math.min(s.row,f),c=Math.max(i.row,c),d=Math.min(s.col,d),p=Math.max(i.col,p)),(1<(parseInt(ee(n[c][r]).attr("rowspan"),10)||1)||1<(parseInt(ee(n[c][r]).attr("colspan"),10)||1))&&(i=x((s=A(n[c][r],n)).row,s.col,n),f=Math.min(s.row,f),c=Math.max(i.row,c),d=Math.min(s.col,d),p=Math.max(i.col,p));return f==e&&c==t&&d==a&&p==l?{min_i:e,max_i:t,min_j:a,max_j:l}:h(f,c,d,p,n)}(Math.min(l.row,n.row),Math.max(l.row,n.row),Math.min(l.col,n.col),Math.max(l.col,n.col),a);v(),e.classList.add("fr-cell-fixed"),t.classList.add("fr-cell-handler");for(var r=o.min_i;r<=o.max_i;r++)for(var s=o.min_j;s<=o.max_j;s++)ee(a[r][s]).addClass("fr-selected-cell")}}function n(e){var t=null,a=ee(e.target);return"TD"==e.target.tagName||"TH"==e.target.tagName?t=e.target:0<a.closest("th",a.closest("thead")[0]).length?t=a.closest("th",a.closest("thead")[0]).get(0):0<a.closest("td",a.closest("tr")[0]).length&&(t=a.closest("td",a.closest("tr")[0]).get(0)),-1===R.$el.html.toString().search(t)?null:t}function $(){v(),R.popups.hide("table.edit")}function e(e){var t=n(e);if("false"==ee(t).parents("[contenteditable]").not(".fr-element").not(".fr-img-caption").not("body").first().attr("contenteditable"))return!0;if(0<V().length&&!t&&$(),!R.edit.isDisabled()||R.popups.isVisible("table.edit"))if(1!=e.which||1==e.which&&R.helpers.isMac()&&e.ctrlKey)(3==e.which||1==e.which&&R.helpers.isMac()&&e.ctrlKey)&&t&&$();else if(q=!0,t){0<V().length&&!e.shiftKey&&$(),e.stopPropagation(),R.events.trigger("image.hideResizer"),R.events.trigger("video.hideResizer"),U=!0;var a=t.tagName.toLowerCase();e.shiftKey&&0<R.$el.find("".concat(a,".fr-selected-cell")).length?ee(R.$el.find("".concat(a,".fr-selected-cell")).closest("table")).is(ee(t).closest("table"))?C(J,t):_():((R.keys.ctrlKey(e)||e.shiftKey)&&(1<V().length||0===ee(t).find(R.selection.element()).length&&!ee(t).is(R.selection.element()))&&_(),J=t,0<R.opts.tableEditButtons.length&&C(J,J))}}function a(e){if(!R.edit.isDisabled()&&R.popups.areVisible())return!0;if(U||R.$tb.is(e.target)||R.$tb.is(ee(e.target).closest(".fr-toolbar"))||(0<V().length&&R.toolbar.enable(),v()),!(1!=e.which||1==e.which&&R.helpers.isMac()&&e.ctrlKey)&&(q=!1,U&&(U=!1,n(e)||1!=V().length?0<V().length&&(R.selection.isCollapsed()?h():(v(),R.edit.on())):v()),Q)){Q=!1,X.removeClass("fr-moving"),R.$el.removeClass("fr-no-selection"),R.edit.on();var t=parseFloat(X.css("left"))+R.opts.tableResizerOffset+R.$wp.offset().left;R.opts.iframe&&(t-=R.$iframe.offset().left),X.data("release-position",t),X.removeData("max-left"),X.removeData("max-right"),function C(){var e=X.data("origin"),t=X.data("release-position");if(e!==t){var a=X.data("first"),l=X.data("second"),n=X.data("table"),o=n.outerWidth();if(R.undo.canDo()||R.undo.saveStep(),null!=a&&null!=l){var r,s,i,f=O(n),c=[],d=[],p=[],h=[];for(r=0;r<f.length;r++)s=ee(f[r][a]),i=ee(f[r][l]),c[r]=s.outerWidth(),p[r]=i.outerWidth(),d[r]=c[r]/o*100,h[r]=p[r]/o*100;for(r=0;r<f.length;r++)if(s=ee(f[r][a]),i=ee(f[r][l]),f[r][a]!=f[r][l]){var u=(d[r]*(c[r]+t-e)/c[r]).toFixed(4);s.css("width",u+"%"),i.css("width",(d[r]+h[r]-u).toFixed(4)+"%")}}else{var b,g=n.parent(),m=o/g.width()*100,v=(parseInt(n.css("margin-left"),10)||0)/g.width()*100,w=(parseInt(n.css("margin-right"),10)||0)/g.width()*100;"rtl"==R.opts.direction&&0===l||"rtl"!=R.opts.direction&&0!==l?(b=(o+t-e)/o*m,n.css("margin-right","calc(100% - ".concat(Math.round(b).toFixed(4),"% - ").concat(Math.round(v).toFixed(4),"%)"))):("rtl"==R.opts.direction&&0!==l||"rtl"!=R.opts.direction&&0===l)&&(b=(o-t+e)/o*m,n.css("margin-left","calc(100% - ".concat(Math.round(b).toFixed(4),"% - ").concat(Math.round(w).toFixed(4),"%)"))),n.css("width","".concat(Math.round(b).toFixed(4),"%"))}R.selection.restore(),R.undo.saveStep(),R.events.trigger("table.resized",[n.get(0)])}X.removeData("origin"),X.removeData("release-position"),X.removeData("first"),X.removeData("second"),X.removeData("table")}(),S()}V().length||(R.$el.removeClass("fr-no-selection"),R.edit.on())}function E(e){if(R.events.$on(ee("input"),"click",j),!0===U&&0<R.opts.tableEditButtons.length){if(ee(e.currentTarget).closest("table").is(P())){if("TD"==e.currentTarget.tagName&&0===R.$el.find("th.fr-selected-cell").length)return void C(J,e.currentTarget);if("TH"==e.currentTarget.tagName&&0===R.$el.find("td.fr-selected-cell").length)return void C(J,e.currentTarget)}_()}}function D(e,t,a,l){for(var n,o=t;o!=R.el&&"TD"!=o.tagName&&"TH"!=o.tagName&&("up"==l?n=o.previousElementSibling:"down"==l&&(n=o.nextElementSibling),!n);)o=o.parentNode;"TD"==o.tagName||"TH"==o.tagName?function r(e,t){for(var a=e;a&&"TABLE"!=a.tagName&&a.parentNode!=R.el;)a=a.parentNode;if(a&&"TABLE"==a.tagName){var l=O(ee(a));"up"==t?y(A(e,l),a,l):"down"==t&&M(A(e,l),a,l)}}(o,l):n&&("up"==l&&R.selection.setAtEnd(n),"down"==l&&R.selection.setAtStart(n))}function y(e,t,a){0<e.row?R.selection.setAtEnd(a[e.row-1][e.col]):D(0,t,0,"up")}function M(e,t,a){var l=parseInt(a[e.row][e.col].getAttribute("rowspan"),10)||1;e.row<a.length-l?R.selection.setAtStart(a[e.row+l][e.col]):D(0,t,0,"down")}function S(){X&&(X.find("div").css("opacity",0),X.css("top",0),X.css("left",0),X.css("height",0),X.find("div").css("height",0),X.hide())}function I(){G&&G.removeClass("fr-visible").css("left","-9999px")}function N(e,t){var a=ee(t),l=a.closest("table"),n=l.parent();if(t&&"TD"!=t.tagName&&"TH"!=t.tagName&&(0<a.closest("td").length?t=a.closest("td"):0<a.closest("th").length&&(t=a.closest("th"))),!t||"TD"!=t.tagName&&"TH"!=t.tagName)X&&a.get(0)!=X.get(0)&&a.parent().get(0)!=X.get(0)&&R.core.sameInstance(X)&&S();else{if(a=ee(t),0===R.$el.find(a).length)return!1;var o=a.offset().left-1,r=o+a.outerWidth();if(Math.abs(e.pageX-o)<=R.opts.tableResizerOffset||Math.abs(r-e.pageX)<=R.opts.tableResizerOffset){var s,i,f,c,d,p=O(l),h=A(t,p),u=x(h.row,h.col,p),b=l.offset().top,g=l.outerHeight()-1;"rtl"!=R.opts.direction?e.pageX-o<=R.opts.tableResizerOffset?(f=o,0<h.col?(c=o-k(h.col-1,p)+R.opts.tableResizingLimit,d=o+k(h.col,p)-R.opts.tableResizingLimit,s=h.col-1,i=h.col):(s=null,i=0,c=l.offset().left-1-parseInt(l.css("margin-left"),10),d=l.offset().left-1+l.width()-p[0].length*R.opts.tableResizingLimit)):r-e.pageX<=R.opts.tableResizerOffset&&(f=r,u.col<p[u.row].length&&p[u.row][u.col+1]?(c=r-k(u.col,p)+R.opts.tableResizingLimit,d=r+k(u.col+1,p)-R.opts.tableResizingLimit,s=u.col,i=u.col+1):(s=u.col,i=null,c=l.offset().left-1+p[0].length*R.opts.tableResizingLimit,d=n.offset().left-1+n.width()+parseFloat(n.css("padding-left")))):r-e.pageX<=R.opts.tableResizerOffset?(f=r,0<h.col?(c=r-k(h.col,p)+R.opts.tableResizingLimit,d=r+k(h.col-1,p)-R.opts.tableResizingLimit,s=h.col,i=h.col-1):(s=null,i=0,c=l.offset().left+p[0].length*R.opts.tableResizingLimit,d=n.offset().left-1+n.width()+parseFloat(n.css("padding-left")))):e.pageX-o<=R.opts.tableResizerOffset&&(f=o,u.col<p[u.row].length&&p[u.row][u.col+1]?(c=o-k(u.col+1,p)+R.opts.tableResizingLimit,d=o+k(u.col,p)-R.opts.tableResizingLimit,s=u.col+1,i=u.col):(s=u.col,i=null,c=n.offset().left+parseFloat(n.css("padding-left")),d=l.offset().left-1+l.width()-p[0].length*R.opts.tableResizingLimit)),X||function E(){R.shared.$table_resizer||(R.shared.$table_resizer=ee(document.createElement("div")).attr("class","fr-table-resizer").html("<div></div>")),X=R.shared.$table_resizer,R.events.$on(X,"mousedown",function(e){return!R.core.sameInstance(X)||(0<V().length&&$(),1==e.which?(R.selection.save(),Q=!0,X.addClass("fr-moving"),_(),R.edit.off(),X.find("div").css("opacity",1),!1):void 0)}),R.events.$on(X,"mousemove",function(e){if(!R.core.sameInstance(X))return!0;Q&&(R.opts.iframe&&(e.pageX-=R.$iframe.offset().left),W(e))}),R.events.on("shared.destroy",function(){X.html("").removeData().remove(),X=null},!0),R.events.on("destroy",function(){R.$el.find(".fr-selected-cell").removeClass("fr-selected-cell"),ee("body").first().append(X.hide())},!0)}(),X.data("table",l),X.data("first",s),X.data("second",i),X.data("instance",R),R.$wp.append(X);var m=f-R.win.pageXOffset-R.opts.tableResizerOffset-R.$wp.offset().left,v=b-R.$wp.offset().top+R.$wp.scrollTop();if(R.opts.iframe){var w=R.helpers.getPX(R.$wp.find(".fr-iframe").css("padding-top")),C=R.helpers.getPX(R.$wp.find(".fr-iframe").css("padding-left"));m+=R.$iframe.offset().left+C,v+=R.$iframe.offset().top+w,c+=R.$iframe.offset().left,d+=R.$iframe.offset().left}X.data("max-left",c),X.data("max-right",d),X.data("origin",f-R.win.pageXOffset),X.css("top",v),X.css("left",m),X.css("height",g),X.find("div").css("height",g),X.css("padding-left",R.opts.tableResizerOffset),X.css("padding-right",R.opts.tableResizerOffset),X.show()}else R.core.sameInstance(X)&&S()}}function T(e,t){if(R.$box.find(".fr-line-breaker").isVisible())return!1;G||F(),R.$box.append(G),G.data("instance",R);var a,l=ee(t).find("tr").first(),n=e.pageX,o=0,r=0;if(R.opts.iframe){var s=R.helpers.getPX(R.$wp.find(".fr-iframe").css("padding-top")),i=R.helpers.getPX(R.$wp.find(".fr-iframe").css("padding-left"));o+=R.$iframe.offset().left-R.helpers.scrollLeft()+i,r+=R.$iframe.offset().top-R.helpers.scrollTop()+s}l.find("th, td").each(function(){var e=ee(this);return e.offset().left<=n&&n<e.offset().left+e.outerWidth()/2?(a=parseInt(G.find("a").css("width"),10),G.css("top",r+e.offset().top-R.$box.offset().top-a-5),G.css("left",o+e.offset().left-R.$box.offset().left-a/2),G.data("selected-cell",e),G.data("position","before"),G.addClass("fr-visible"),!1):e.offset().left+e.outerWidth()/2<=n&&n<e.offset().left+e.outerWidth()?(a=parseInt(G.find("a").css("width"),10),G.css("top",r+e.offset().top-R.$box.offset().top-a-5),G.css("left",o+e.offset().left-R.$box.offset().left+e.outerWidth()-a/2),G.data("selected-cell",e),G.data("position","after"),G.addClass("fr-visible"),!1):void 0})}function K(e,t){if(R.$box.find(".fr-line-breaker").isVisible())return!1;G||F(),R.$box.append(G),G.data("instance",R);var a,l=ee(t),n=e.pageY,o=0,r=0;if(R.opts.iframe){var s=R.helpers.getPX(R.$wp.find(".fr-iframe").css("padding-top")),i=R.helpers.getPX(R.$wp.find(".fr-iframe").css("padding-left"));o+=R.$iframe.offset().left-R.helpers.scrollLeft()+i,r+=R.$iframe.offset().top-R.helpers.scrollTop()+s}l.find("tr").each(function(){var e=ee(this);return e.offset().top<=n&&n<e.offset().top+e.outerHeight()/2?(a=parseInt(G.find("a").css("width"),10),G.css("top",r+e.offset().top-R.$box.offset().top-a/2),G.css("left",o+e.offset().left-R.$box.offset().left-a-5),G.data("selected-cell",e.find("td").first()),G.data("position","above"),G.addClass("fr-visible"),!1):e.offset().top+e.outerHeight()/2<=n&&n<e.offset().top+e.outerHeight()?(a=parseInt(G.find("a").css("width"),10),G.css("top",r+e.offset().top-R.$box.offset().top+e.outerHeight()-a/2),G.css("left",o+e.offset().left-R.$box.offset().left-a-5),G.data("selected-cell",e.find("td").first()),G.data("position","below"),G.addClass("fr-visible"),!1):void 0})}function B(e){Z=null;var t=R.doc.elementFromPoint(e.pageX-R.win.pageXOffset,e.pageY-R.win.pageYOffset);R.opts.tableResizer&&(!R.popups.areVisible()||R.popups.areVisible()&&R.popups.isVisible("table.edit"))&&N(e,t),!R.opts.tableInsertHelper||R.popups.areVisible()||R.$tb.hasClass("fr-inline")&&R.$tb.isVisible()||function o(e,t){if(0===V().length){var a,l,n;if(t&&("HTML"==t.tagName||"BODY"==t.tagName||R.node.isElement(t)))for(a=1;a<=R.opts.tableInsertHelperOffset;a++){if(l=R.doc.elementFromPoint(e.pageX-R.win.pageXOffset,e.pageY-R.win.pageYOffset+a),ee(l).hasClass("fr-tooltip"))return!0;if(l&&("TH"==l.tagName||"TD"==l.tagName||"TABLE"==l.tagName)&&(ee(l).parents(".fr-wrapper").length||R.opts.iframe)&&"false"!=ee(l).closest("table").attr("contenteditable"))return T(e,ee(l).closest("table")),!0;if(n=R.doc.elementFromPoint(e.pageX-R.win.pageXOffset+a,e.pageY-R.win.pageYOffset),ee(n).hasClass("fr-tooltip"))return!0;if(n&&("TH"==n.tagName||"TD"==n.tagName||"TABLE"==n.tagName)&&(ee(n).parents(".fr-wrapper").length||R.opts.iframe)&&"false"!=ee(n).closest("table").attr("contenteditable"))return K(e,ee(n).closest("table")),!0}R.core.sameInstance(G)&&I()}}(e,t)}function z(){if(Q){var e=X.data("table").offset().top-R.win.pageYOffset;if(R.opts.iframe){var t=R.helpers.getPX(R.$wp.find(".fr-iframe").css("padding-top"));e+=R.$iframe.offset().top-R.helpers.scrollTop()+t}X.css("top",e)}}function k(e,t){var a,l=ee(t[0][e]).outerWidth();for(a=1;a<t.length;a++)l=Math.min(l,ee(t[a][e]).outerWidth());return l}function Y(e,t,a){var l,n=0;for(l=e;l<=t;l++)n+=k(l,a);return n}function W(e){if(1<V().length&&q&&_(),!1===q&&!1===U&&!1===Q)Z&&clearTimeout(Z),R.edit.isDisabled()&&!R.popups.isVisible("table.edit")||(Z=setTimeout(B,30,e));else if(Q){var t=e.pageX-R.win.pageXOffset;R.opts.iframe&&(t+=R.$iframe.offset().left);var a=X.data("max-left"),l=X.data("max-right");a<=t&&t<=l?X.css("left",t-R.opts.tableResizerOffset-R.$wp.offset().left):t<a&&parseFloat(X.css("left"),10)>a-R.opts.tableResizerOffset?X.css("left",a-R.opts.tableResizerOffset-R.$wp.offset().left):l<t&&parseFloat(X.css("left"),10)<l-R.opts.tableResizerOffset&&X.css("left",l-R.opts.tableResizerOffset-R.$wp.offset().left)}else q&&I()}function L(e){R.node.isEmpty(e.get(0))?e.prepend(me.MARKERS):e.prepend(me.START_MARKER).append(me.END_MARKER)}function F(){R.shared.$ti_helper||(R.shared.$ti_helper=ee(document.createElement("div")).attr("class","fr-insert-helper").html('<a class="fr-floating-btn" role="button" tabIndex="-1" title="'.concat(R.language.translate("Insert"),'"><svg viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg"><path d="M22,16.75 L16.75,16.75 L16.75,22 L15.25,22.000 L15.25,16.75 L10,16.75 L10,15.25 L15.25,15.25 L15.25,10 L16.75,10 L16.75,15.25 L22,15.25 L22,16.75 Z"/></svg></a>')),R.events.bindClick(R.shared.$ti_helper,"a",function(){var e=G.data("selected-cell"),t=G.data("position"),a=G.data("instance")||R;"before"==t?(R.undo.saveStep(),e.addClass("fr-selected-cell"),a.table.insertColumn(t),e.removeClass("fr-selected-cell"),R.undo.saveStep()):"after"==t?(R.undo.saveStep(),e.addClass("fr-selected-cell"),a.table.insertColumn(t),e.removeClass("fr-selected-cell"),R.undo.saveStep()):"above"==t?(R.undo.saveStep(),e.addClass("fr-selected-cell"),a.table.insertRow(t),e.removeClass("fr-selected-cell"),R.undo.saveStep()):"below"==t&&(R.undo.saveStep(),e.addClass("fr-selected-cell"),a.table.insertRow(t),e.removeClass("fr-selected-cell"),R.undo.saveStep()),I()}),R.events.on("shared.destroy",function(){R.shared.$ti_helper.html("").removeData().remove(),R.shared.$ti_helper=null},!0),R.events.$on(R.shared.$ti_helper,"mousemove",function(e){e.stopPropagation()},!0),R.events.$on(ee(R.o_win),"scroll",function(){I()},!0),R.events.$on(R.$wp,"scroll",function(){I()},!0)),G=R.shared.$ti_helper,R.events.on("destroy",function(){G=null}),R.tooltip.bind(R.$box,".fr-insert-helper > a.fr-floating-btn")}function H(){J=null,clearTimeout(Z)}function V(){return R.el.querySelectorAll(".fr-selected-cell")}function P(){var e=V();if(e.length){for(var t=e[0];t&&"TABLE"!=t.tagName&&t.parentNode!=R.el;)t=t.parentNode;return t&&"TABLE"==t.tagName?ee(t):ee([])}return ee([])}function j(){U=!1}var X,G,U,q,J,Z,Q,ee=R.$;return{_init:function te(){if(!R.$wp)return!1;if(!R.helpers.isMobile()){Q=U=q=!1,R.events.$on(R.$el,"mousedown",e),R.popups.onShow("image.edit",function(){v(),U=q=!1}),R.popups.onShow("link.edit",function(){v(),U=q=!1}),R.events.on("commands.mousedown",function(e){0<e.parents(".fr-toolbar").length&&v()}),R.events.$on(R.$el,"mouseover","th, td",E),R.events.$on(R.$win,"mouseup",a),R.opts.iframe&&R.events.$on(ee(R.o_win),"mouseup",a),R.events.$on(R.$win,"mousemove",W),R.events.$on(ee(R.o_win),"scroll",z),R.events.on("contentChanged",function(){0<V().length&&(h(),R.$el.find("img").on("load.selected-cells",function(){ee(this).off("load.selected-cells"),0<V().length&&h()}))}),R.events.$on(ee(R.o_win),"resize",function(){v()}),R.events.on("toolbar.esc",function(){if(0<V().length)return R.events.disableBlur(),R.events.focus(),!1},!0),R.events.$on(ee(R.o_win),"keydown",function(){q&&U&&(U=q=!1,R.$el.removeClass("fr-no-selection"),R.edit.on(),R.selection.setAtEnd(R.$el.find(".fr-selected-cell").last().get(0)),R.selection.restore(),v())}),R.events.$on(R.$el,"keydown",function(e){e.shiftKey?!1===function r(e){var t=V();if(null!=t&&0<t.length){var a,l=O(),n=e.which,o=A(1==t.length?a=t[0]:(a=R.el.querySelector(".fr-cell-fixed"),R.el.querySelector(".fr-cell-handler")),l);if(me.KEYCODE.ARROW_RIGHT==n){if(o.col<l[0].length-1)return C(a,l[o.row][o.col+1]),!1}else if(me.KEYCODE.ARROW_DOWN==n){if(o.row<l.length-1)return C(a,l[o.row+1][o.col]),!1}else if(me.KEYCODE.ARROW_LEFT==n){if(0<o.col)return C(a,l[o.row][o.col-1]),!1}else if(me.KEYCODE.ARROW_UP==n&&0<o.row)return C(a,l[o.row-1][o.col]),!1}}(e)&&setTimeout(function(){h()},0):function s(e){var t=e.which,a=R.selection.blocks();if(a.length&&("TD"==(a=a[0]).tagName||"TH"==a.tagName)){for(var l=a;l&&"TABLE"!=l.tagName&&l.parentNode!=R.el;)l=l.parentNode;if(l&&"TABLE"==l.tagName&&(me.KEYCODE.ARROW_LEFT==t||me.KEYCODE.ARROW_UP==t||me.KEYCODE.ARROW_RIGHT==t||me.KEYCODE.ARROW_DOWN==t)&&(0<V().length&&$(),R.browser.webkit&&(me.KEYCODE.ARROW_UP==t||me.KEYCODE.ARROW_DOWN==t))){var n=R.selection.ranges(0).startContainer;if(n.nodeType==Node.TEXT_NODE&&(me.KEYCODE.ARROW_UP==t&&(n.previousSibling&&"BR"!==n.previousSibling.tagName||n.previousSibling&&"BR"===n.previousSibling.tagName&&n.previousSibling.previousSibling)||me.KEYCODE.ARROW_DOWN==t&&(n.nextSibling&&"BR"!==n.nextSibling.tagName||n.nextSibling&&"BR"===n.nextSibling.tagName&&n.nextSibling.nextSibling)))return;e.preventDefault(),e.stopPropagation();var o=O(ee(l)),r=A(a,o);return me.KEYCODE.ARROW_UP==t?y(r,l,o):me.KEYCODE.ARROW_DOWN==t&&M(r,l,o),R.selection.restore(),!1}}}(e)}),R.events.on("keydown",function(e){if(!1===function l(e){if(e.which==me.KEYCODE.TAB){var t;if(0<V().length)t=R.$el.find(".fr-selected-cell").last();else{var a=R.selection.element();"TD"==a.tagName||"TH"==a.tagName?t=ee(a):a!=R.el&&(0<ee(a).parentsUntil(R.$el,"td").length?t=ee(a).parents("td").first():0<ee(a).parentsUntil(R.$el,"th").length&&(t=ee(a).parents("th").first()))}if(t)return e.preventDefault(),!!(0===R.selection.get().focusOffset&&0<ee(R.selection.element()).parentsUntil(R.$el,"ol, ul").length&&(0<ee(R.selection.element()).closest("li").prev().length||ee(R.selection.element()).is("li")&&0<ee(R.selection.element()).prev().length))||($(),e.shiftKey?0<t.prev().length?L(t.prev()):0<t.closest("tr").length&&0<t.closest("tr").prev().length?L(t.closest("tr").prev().find("td").last()):0<t.closest("tbody").length&&0<t.closest("table").find("thead tr").length&&L(t.closest("table").find("thead tr th").last()):0<t.next().length?L(t.next()):0<t.closest("tr").length&&0<t.closest("tr").next().length?L(t.closest("tr").next().find("td").first()):0<t.closest("thead").length&&0<t.closest("table").find("tbody tr").length?L(t.closest("table").find("tbody tr td").first()):(t.addClass("fr-selected-cell"),i("below"),v(),L(t.closest("tr").next().find("td").first())),R.selection.restore(),!1)}}(e))return!1;var t=V();if(0<t.length){if(0<t.length&&R.keys.ctrlKey(e)&&e.which==me.KEYCODE.A)return v(),R.popups.isVisible("table.edit")&&R.popups.hide("table.edit"),t=[],!0;if(e.which==me.KEYCODE.ESC&&R.popups.isVisible("table.edit"))return v(),R.popups.hide("table.edit"),e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),!(t=[]);if(1<t.length&&(e.which==me.KEYCODE.BACKSPACE||e.which==me.KEYCODE.DELETE)){R.undo.saveStep();for(var a=0;a<t.length;a++)ee(t[a]).html("<br>"),a==t.length-1&&ee(t[a]).prepend(me.MARKERS);return R.selection.restore(),R.undo.saveStep(),!(t=[])}if(1<t.length&&e.which!=me.KEYCODE.F10&&!R.keys.isBrowserAction(e))return e.preventDefault(),!(t=[])}else if(!(t=[])===function n(e){if(
e.altKey&&e.which==me.KEYCODE.SPACE){var t,a=R.selection.element();if("TD"==a.tagName||"TH"==a.tagName?t=a:0<ee(a).closest("td").length?t=ee(a).closest("td").get(0):0<ee(a).closest("th").length&&(t=ee(a).closest("th").get(0)),t)return e.preventDefault(),C(t,t),h(),!1}}(e))return!1},!0);var t=[];R.events.on("html.beforeGet",function(){t=V();for(var e=0;e<t.length;e++)t[e].className=(t[e].className||"").replace(/fr-selected-cell/g,"")}),R.events.on("html.afterGet",function(){for(var e=0;e<t.length;e++)t[e].className=(t[e].className?t[e].className.trim()+" ":"")+"fr-selected-cell";t=[]}),o(!0),r(!0)}R.events.on("destroy",H)},insert:function ae(e,t){var a,l,n="<table "+(R.opts.tableDefaultWidth?'style="width: '+R.opts.tableDefaultWidth+';" ':"")+'class="fr-inserted-table"><tbody>',o=100/t;for(a=0;a<e;a++){for(n+="<tr>",l=0;l<t;l++)n+="<td"+(R.opts.tableDefaultWidth?' style="width: '+o.toFixed(4)+'%;"':"")+">",0===a&&0===l&&(n+=me.MARKERS),n+="<br></td>";n+="</tr>"}n+="</tbody></table>",R.html.insert(n),R.selection.restore();var r=R.$el.find(".fr-inserted-table");r.removeClass("fr-inserted-table"),R.events.trigger("table.inserted",[r.get(0)])},remove:p,insertRow:i,deleteRow:function le(){var e=P();if(0<e.length){var t,a,l,n=O(),o=w(n);if(null==o)return;if(0===o.min_i&&o.max_i==n.length-1)p();else{for(t=o.max_i;t>=o.min_i;t--){for(l=ee(e.find("tr").not(e.find("> table tr")).get(t)),a=0;a<n[t].length;a++)if(0===a||n[t][a]!=n[t][a-1]){var r=ee(n[t][a]);if(1<parseInt(r.attr("rowspan"),10)){var s=parseInt(r.attr("rowspan"),10)-1;1==s?r.removeAttr("rowspan"):r.attr("rowspan",s)}if(t<n.length-1&&n[t][a]==n[t+1][a]&&(0===t||n[t][a]!=n[t-1][a])){for(var i=n[t][a],f=a;0<f&&n[t][f]==n[t][f-1];)f--;0===f?ee(e.find("tr").not(e.find("> table tr")).get(t+1)).prepend(i):ee(n[t+1][f-1])[0].parentNode&&ee(n[t+1][f-1])[0].insertAdjacentElement("afterend",i)}}var c=l.parent();l.remove(),0===c.find("tr").length&&c.remove(),n=O(e)}g(0,n.length-1,0,n[0].length-1,e),0<o.min_i?R.selection.setAtEnd(n[o.min_i-1][0]):R.selection.setAtEnd(n[0][0]),R.selection.restore(),R.popups.hide("table.edit")}}},insertColumn:function ne(i){var e=P();if(0<e.length){var f,c=O(),t=w(c);f="before"==i?t.min_j:t.max_j;var a,d=100/c[0].length,p=100/(c[0].length+1);e.find("th, td").each(function(){(a=ee(this)).data("old-width",a.outerWidth()/e.outerWidth()*100)}),e.find("tr").not(e.find("> table tr")).each(function(e){for(var t,a=ee(this),l=0,n=0;l-1<f;){if(!(t=a.find("> th, > td").get(n))){t=null;break}t==c[e][l]?(l+=parseInt(ee(t).attr("colspan"),10)||1,n++):(l+=parseInt(ee(c[e][l]).attr("colspan"),10)||1,"after"==i&&(t=0===n?-1:a.find("> th, > td").get(n-1)))}var o,r=ee(t);if("after"==i&&f<l-1||"before"==i&&0<f&&c[e][f]==c[e][f-1]){if(0===e||0<e&&c[e][f]!=c[e-1][f]){var s=parseInt(r.attr("colspan"),10)+1;r.attr("colspan",s),r.css("width",(r.data("old-width")*p/d+p).toFixed(4)+"%"),r.removeData("old-width")}}else o=0<a.find("th").length?'<th style="width: '.concat(p.toFixed(4),'%;"><br></th>'):'<td style="width: '.concat(p.toFixed(4),'%;"><br></td>'),-1==t?a.prepend(o):null==t?a.append(o):"before"==i?r.before(o):"after"==i&&r[0].parentNode&&r[0].insertAdjacentHTML("afterend",o)}),e.find("th, td").each(function(){(a=ee(this)).data("old-width")&&(a.css("width",(a.data("old-width")*p/d).toFixed(4)+"%"),a.removeData("old-width"))}),R.popups.isVisible("table.edit")&&h()}},deleteColumn:function oe(){var e=P();if(0<e.length){var t,a,l,n=O(),o=w(n);if(null==o)return;if(0===o.min_j&&o.max_j==n[0].length-1)p();else{var r=0;for(t=0;t<n.length;t++)for(a=0;a<n[0].length;a++)(l=ee(n[t][a])).hasClass("fr-selected-cell")||(l.data("old-width",l.outerWidth()/e.outerWidth()*100),(a<o.min_j||a>o.max_j)&&(r+=l.outerWidth()/e.outerWidth()*100));for(r/=n.length,a=o.max_j;a>=o.min_j;a--)for(t=0;t<n.length;t++)if(0===t||n[t][a]!=n[t-1][a])if(l=ee(n[t][a]),1<(parseInt(l.attr("colspan"),10)||1)){var s=parseInt(l.attr("colspan"),10)-1;1==s?l.removeAttr("colspan"):l.attr("colspan",s),l.css("width",(100*(l.data("old-width")-k(a,n))/r).toFixed(4)+"%"),l.removeData("old-width")}else{var i=ee(l.parent().get(0));l.remove(),0===i.find("> th, > td").length&&(0===i.prev().length||0===i.next().length||i.prev().find("> th[rowspan], > td[rowspan]").length<i.prev().find("> th, > td").length)&&i.remove()}g(0,n.length-1,0,n[0].length-1,e),0<o.min_j?R.selection.setAtEnd(n[o.min_i][o.min_j-1]):R.selection.setAtEnd(n[o.min_i][0]),R.selection.restore(),R.popups.hide("table.edit"),e.find("th, td").each(function(){(l=ee(this)).data("old-width")&&(l.css("width",(100*l.data("old-width")/r).toFixed(4)+"%"),l.removeData("old-width"))})}}},mergeCells:function re(){if(1<V().length&&(0===R.$el.find("th.fr-selected-cell").length||0===R.$el.find("td.fr-selected-cell").length)){m();var e,t,a=w(O());if(null==a)return;var l=R.$el.find(".fr-selected-cell"),n=ee(l[0]),o=n.parent().find(".fr-selected-cell"),r=n.closest("table"),s=n.html(),i=0;for(e=0;e<o.length;e++)i+=ee(o[e]).outerWidth();for(n.css("width",Math.min(100,i/r.outerWidth()*100).toFixed(4)+"%"),a.min_j<a.max_j&&n.attr("colspan",a.max_j-a.min_j+1),a.min_i<a.max_i&&n.attr("rowspan",a.max_i-a.min_i+1),e=1;e<l.length;e++)"<br>"!=(t=ee(l[e])).html()&&""!==t.html()&&(s+="<br>".concat(t.html())),t.remove();n.html(s),R.selection.setAtEnd(n.get(0)),R.selection.restore(),R.toolbar.enable(),u(a.min_i,a.max_i,r);var f=r.find("tr:empty");for(e=f.length-1;0<=e;e--)ee(f[e]).remove();c(a.min_j,a.max_j,r),h()}},splitCellVertically:function se(){if(1==V().length){var e=R.$el.find(".fr-selected-cell"),t=parseInt(e.attr("colspan"),10)||1,a=e.parent().outerWidth(),l=e.outerWidth(),n=e.clone().html("<br>"),o=O(),r=A(e.get(0),o);if(1<t){var s=Math.ceil(t/2);l=Y(r.col,r.col+s-1,o)/a*100;var i=Y(r.col+s,r.col+t-1,o)/a*100;1<s?e.attr("colspan",s):e.removeAttr("colspan"),1<t-s?n.attr("colspan",t-s):n.removeAttr("colspan"),e.css("width",l.toFixed(4)+"%"),n.css("width",i.toFixed(4)+"%")}else{var f;for(f=0;f<o.length;f++)if(0===f||o[f][r.col]!=o[f-1][r.col]){var c=ee(o[f][r.col]);if(!c.is(e)){var d=(parseInt(c.attr("colspan"),10)||1)+1;c.attr("colspan",d)}}l=l/a*100/2,e.css("width","".concat(l.toFixed(4),"%")),n.css("width","".concat(l.toFixed(4),"%"))}e[0].parentNode&&e[0].insertAdjacentElement("afterend",n[0]),v(),R.popups.hide("table.edit")}},splitCellHorizontally:function ie(){if(1==V().length){var e=R.$el.find(".fr-selected-cell"),t=e.parent(),a=e.closest("table"),l=parseInt(e.attr("rowspan"),10),n=O(),o=A(e.get(0),n),r=e.clone().html("<br>");if(1<l){var s=Math.ceil(l/2);1<s?e.attr("rowspan",s):e.removeAttr("rowspan"),1<l-s?r.attr("rowspan",l-s):r.removeAttr("rowspan");for(var i=o.row+s,f=0===o.col?o.col:o.col-1;0<=f&&(n[i][f]==n[i][f-1]||0<i&&n[i][f]==n[i-1][f]);)f--;-1==f?ee(a.find("tr").not(a.find("> table tr")).get(i)).prepend(r):ee(n[i][f])[0].parentNode&&ee(n[i][f])[0].insertAdjacentElement("afterend",r[0])}else{var c,d=ee(document.createElement("tr")).append(r);for(c=0;c<n[0].length;c++)if(0===c||n[o.row][c]!=n[o.row][c-1]){var p=ee(n[o.row][c]);p.is(e)||p.attr("rowspan",(parseInt(p.attr("rowspan"),10)||1)+1)}t[0].parentNode&&t[0].insertAdjacentElement("afterend",d[0])}v(),R.popups.hide("table.edit")}},addHeader:function fe(){var e=P();if(0<e.length&&0===e.find("th").length){var t,a="<thead><tr>",l=0;for(e.find("tr").first().find("> td").each(function(){var e=ee(this);l+=parseInt(e.attr("colspan"),10)||1}),t=0;t<l;t++)a+="<th><br></th>";a+="</tr></thead>",e.prepend(a),h()}},removeHeader:function ce(){var e=P(),t=e.find("thead");if(0<t.length)if(0===e.find("tbody tr").length)p();else if(t.remove(),0<V().length)h();else{R.popups.hide("table.edit");var a=e.find("tbody tr").first().find("td").first().get(0);a&&(R.selection.setAtEnd(a),R.selection.restore())}},setBackground:t,showInsertPopup:function de(){var e=R.$tb.find('.fr-command[data-cmd="insertTable"]'),t=R.popups.get("table.insert");if(t||(t=o()),!t.hasClass("fr-active")){R.popups.refresh("table.insert"),R.popups.setContainer("table.insert",R.$tb);var a=R.button.getPosition(e),l=a.left,n=a.top;R.popups.show("table.insert",l,n,e.outerHeight())}},showEditPopup:h,showColorsPopup:s,back:function pe(){0<V().length?h():(R.popups.hide("table.insert"),R.toolbar.showInline())},verticalAlign:function he(e){R.$el.find(".fr-selected-cell").css("vertical-align",e)},horizontalAlign:function ue(e){R.$el.find(".fr-selected-cell").css("text-align",e)},applyStyle:function be(e,t,a,l){if(0<t.length){if(!a){var n=Object.keys(l);n.splice(n.indexOf(e),1),t.removeClass(n.join(" "))}t.toggleClass(e)}},selectedTable:P,selectedCells:V,customColor:function ge(){var e=R.popups.get("table.colors").find(".fr-table-colors-hex-layer input");e.length&&t(e.val())},selectCells:C}},me.DefineIcon("insertTable",{NAME:"table",SVG_KEY:"insertTable"}),me.RegisterCommand("insertTable",{title:"Insert Table",undo:!1,focus:!0,refreshOnCallback:!1,popup:!0,callback:function(){this.popups.isVisible("table.insert")?(this.$el.find(".fr-marker").length&&(this.events.disableBlur(),this.selection.restore()),this.popups.hide("table.insert")):this.table.showInsertPopup()},plugin:"table"}),me.RegisterCommand("tableInsert",{callback:function(e,t,a){this.table.insert(t,a),this.popups.hide("table.insert")}}),me.DefineIcon("tableHeader",{NAME:"header",FA5NAME:"heading",SVG_KEY:"tableHeader"}),me.RegisterCommand("tableHeader",{title:"Table Header",focus:!1,toggle:!0,callback:function(){this.popups.get("table.edit").find('.fr-command[data-cmd="tableHeader"]').hasClass("fr-active")?this.table.removeHeader():this.table.addHeader()},refresh:function(e){var t=this.table.selectedTable();0<t.length&&(0===t.find("th").length?e.removeClass("fr-active").attr("aria-pressed",!1):e.addClass("fr-active").attr("aria-pressed",!0))}}),me.DefineIcon("tableRows",{NAME:"bars",SVG_KEY:"row"}),me.RegisterCommand("tableRows",{type:"dropdown",focus:!1,title:"Row",options:{above:"Insert row above",below:"Insert row below","delete":"Delete row"},html:function(){var e='<ul class="fr-dropdown-list" role="presentation">',t=me.COMMANDS.tableRows.options;for(var a in t)t.hasOwnProperty(a)&&(e+='<li role="presentation"><a class="fr-command" tabIndex="-1" role="option" data-cmd="tableRows" data-param1="'+a+'" title="'+this.language.translate(t[a])+'">'+this.language.translate(t[a])+"</a></li>");return e+"</ul>"},callback:function(e,t){"above"==t||"below"==t?this.table.insertRow(t):this.table.deleteRow()}}),me.DefineIcon("tableColumns",{NAME:"bars fa-rotate-90",SVG_KEY:"columns"}),me.RegisterCommand("tableColumns",{type:"dropdown",focus:!1,title:"Column",options:{before:"Insert column before",after:"Insert column after","delete":"Delete column"},html:function(){var e='<ul class="fr-dropdown-list" role="presentation">',t=me.COMMANDS.tableColumns.options;for(var a in t)t.hasOwnProperty(a)&&(e+='<li role="presentation"><a class="fr-command" tabIndex="-1" role="option" data-cmd="tableColumns" data-param1="'.concat(a,'" title="').concat(this.language.translate(t[a]),'">').concat(this.language.translate(t[a]),"</a></li>"));return e+"</ul>"},callback:function(e,t){"before"==t||"after"==t?this.table.insertColumn(t):this.table.deleteColumn()}}),me.DefineIcon("tableCells",{NAME:"square-o",FA5NAME:"square",SVG_KEY:"cellOptions"}),me.RegisterCommand("tableCells",{type:"dropdown",focus:!1,title:"Cell",options:{merge:"Merge cells","vertical-split":"Vertical split","horizontal-split":"Horizontal split"},html:function(){var e='<ul class="fr-dropdown-list" role="presentation">',t=me.COMMANDS.tableCells.options;for(var a in t)t.hasOwnProperty(a)&&(e+='<li role="presentation"><a class="fr-command" tabIndex="-1" role="option" data-cmd="tableCells" data-param1="'.concat(a,'" title="').concat(this.language.translate(t[a]),'">').concat(this.language.translate(t[a]),"</a></li>"));return e+"</ul>"},callback:function(e,t){"merge"==t?this.table.mergeCells():"vertical-split"==t?this.table.splitCellVertically():this.table.splitCellHorizontally()},refreshOnShow:function(e,t){1<this.$el.find(".fr-selected-cell").length?(t.find('a[data-param1="vertical-split"]').addClass("fr-disabled").attr("aria-disabled",!0),t.find('a[data-param1="horizontal-split"]').addClass("fr-disabled").attr("aria-disabled",!0),t.find('a[data-param1="merge"]').removeClass("fr-disabled").attr("aria-disabled",!1)):(t.find('a[data-param1="merge"]').addClass("fr-disabled").attr("aria-disabled",!0),t.find('a[data-param1="vertical-split"]').removeClass("fr-disabled").attr("aria-disabled",!1),t.find('a[data-param1="horizontal-split"]').removeClass("fr-disabled").attr("aria-disabled",!1))}}),me.DefineIcon("tableRemove",{NAME:"trash",SVG_KEY:"removeTable"}),me.RegisterCommand("tableRemove",{title:"Remove Table",focus:!1,callback:function(){this.table.remove()}}),me.DefineIcon("tableStyle",{NAME:"paint-brush",SVG_KEY:"tableStyle"}),me.RegisterCommand("tableStyle",{title:"Table Style",type:"dropdown",focus:!1,html:function(){var e='<ul class="fr-dropdown-list" role="presentation">',t=this.opts.tableStyles;for(var a in t)t.hasOwnProperty(a)&&(e+='<li role="presentation"><a class="fr-command" tabIndex="-1" role="option" data-cmd="tableStyle" data-param1="'.concat(a,'" title="').concat(this.language.translate(t[a]),'">').concat(this.language.translate(t[a]),"</a></li>"));return e+"</ul>"},callback:function(e,t){this.table.applyStyle(t,this.$el.find(".fr-selected-cell").closest("table"),this.opts.tableMultipleStyles,this.opts.tableStyles)},refreshOnShow:function(e,t){var a=this.$,l=this.$el.find(".fr-selected-cell").closest("table");l&&t.find(".fr-command").each(function(){var e=a(this).data("param1"),t=l.hasClass(e);a(this).toggleClass("fr-active",t).attr("aria-selected",t)})}}),me.DefineIcon("tableCellBackground",{NAME:"tint",SVG_KEY:"cellBackground"}),me.RegisterCommand("tableCellBackground",{title:"Cell Background",focus:!1,popup:!0,callback:function(){this.table.showColorsPopup()}}),me.RegisterCommand("tableCellBackgroundColor",{undo:!0,focus:!1,callback:function(e,t){this.table.setBackground(t)}}),me.DefineIcon("tableBack",{NAME:"arrow-left",SVG_KEY:"back"}),me.RegisterCommand("tableBack",{title:"Back",undo:!1,focus:!1,back:!0,callback:function(){this.table.back()},refresh:function(e){0!==this.table.selectedCells().length||this.opts.toolbarInline?(e.removeClass("fr-hidden"),e.next(".fr-separator").removeClass("fr-hidden")):(e.addClass("fr-hidden"),e.next(".fr-separator").addClass("fr-hidden"))}}),me.DefineIcon("tableCellVerticalAlign",{NAME:"arrows-v",FA5NAME:"arrows-alt-v",SVG_KEY:"verticalAlignMiddle"}),me.RegisterCommand("tableCellVerticalAlign",{type:"dropdown",focus:!1,title:"Vertical Align",options:{Top:"Align Top",Middle:"Align Middle",Bottom:"Align Bottom"},html:function(){var e='<ul class="fr-dropdown-list" role="presentation">',t=me.COMMANDS.tableCellVerticalAlign.options;for(var a in t)t.hasOwnProperty(a)&&(e+='<li role="presentation"><a class="fr-command" tabIndex="-1" role="option" data-cmd="tableCellVerticalAlign" data-param1="'.concat(a.toLowerCase(),'" title="').concat(this.language.translate(t[a]),'">').concat(this.language.translate(a),"</a></li>"));return e+"</ul>"},callback:function(e,t){this.table.verticalAlign(t)},refreshOnShow:function(e,t){t.find('.fr-command[data-param1="'+this.$el.find(".fr-selected-cell").css("vertical-align")+'"]').addClass("fr-active").attr("aria-selected",!0)}}),me.DefineIcon("tableCellHorizontalAlign",{NAME:"align-left",SVG_KEY:"alignLeft"}),me.DefineIcon("align-left",{NAME:"align-left",SVG_KEY:"alignLeft"}),me.DefineIcon("align-right",{NAME:"align-right",SVG_KEY:"alignRight"}),me.DefineIcon("align-center",{NAME:"align-center",SVG_KEY:"alignCenter"}),me.DefineIcon("align-justify",{NAME:"align-justify",SVG_KEY:"alignJustify"}),me.RegisterCommand("tableCellHorizontalAlign",{type:"dropdown",focus:!1,title:"Horizontal Align",options:{left:"Align Left",center:"Align Center",right:"Align Right",justify:"Align Justify"},html:function(){var e='<ul class="fr-dropdown-list" role="presentation">',t=me.COMMANDS.tableCellHorizontalAlign.options;for(var a in t)t.hasOwnProperty(a)&&(e+='<li role="presentation"><a class="fr-command fr-title" tabIndex="-1" role="option" data-cmd="tableCellHorizontalAlign" data-param1="'.concat(a,'" title="').concat(this.language.translate(t[a]),'">').concat(this.icon.create("align-".concat(a)),'<span class="fr-sr-only">').concat(this.language.translate(t[a]),"</span></a></li>"));return e+"</ul>"},callback:function(e,t){this.table.horizontalAlign(t)},refresh:function(e){var t=this.table.selectedCells(),a=this.$;t.length&&e.find("> *").first().replaceWith(this.icon.create("align-".concat(this.helpers.getAlignment(a(t[0])))))},refreshOnShow:function(e,t){t.find('.fr-command[data-param1="'+this.helpers.getAlignment(this.$el.find(".fr-selected-cell").first())+'"]').addClass("fr-active").attr("aria-selected",!0)}}),me.DefineIcon("tableCellStyle",{NAME:"magic",SVG_KEY:"cellStyle"}),me.RegisterCommand("tableCellStyle",{title:"Cell Style",type:"dropdown",focus:!1,html:function(){var e='<ul class="fr-dropdown-list" role="presentation">',t=this.opts.tableCellStyles;for(var a in t)t.hasOwnProperty(a)&&(e+='<li role="presentation"><a class="fr-command" tabIndex="-1" role="option" data-cmd="tableCellStyle" data-param1="'.concat(a,'" title="').concat(this.language.translate(t[a]),'">').concat(this.language.translate(t[a]),"</a></li>"));return e+"</ul>"},callback:function(e,t){this.table.applyStyle(t,this.$el.find(".fr-selected-cell"),this.opts.tableCellMultipleStyles,this.opts.tableCellStyles)},refreshOnShow:function(e,t){var a=this.$,l=this.$el.find(".fr-selected-cell").first();l&&t.find(".fr-command").each(function(){var e=a(this).data("param1"),t=l.hasClass(e);a(this).toggleClass("fr-active",t).attr("aria-selected",t)})}}),me.RegisterCommand("tableCellBackgroundCustomColor",{title:"OK",undo:!0,callback:function(){this.table.customColor()}}),me.DefineIcon("tableColorRemove",{NAME:"eraser",SVG_KEY:"remove"})});